<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Ajax学习笔记 | wallleap</title>
  <meta name="keywords" content=" 前端 , web , Ajax ">
  <meta name="description" content="Ajax学习笔记 | wallleap">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="念两句诗          叙别梦、扬州一觉。          【宋代】吴文英《夜游宫·人去西楼雁杳》       .images{ 	float: left;     width: 100%;     height: 300px;     position: relative;     margin: 20px 0">
<meta property="og:type" content="website">
<meta property="og:title" content="图集">
<meta property="og:url" content="https://wallleap.cn/photo/index.html">
<meta property="og:site_name" content="wallleap">
<meta property="og:description" content="念两句诗          叙别梦、扬州一觉。          【宋代】吴文英《夜游宫·人去西楼雁杳》       .images{ 	float: left;     width: 100%;     height: 300px;     position: relative;     margin: 20px 0">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=46b93e4b7d1ed21b79c929e39555baf9/14ce36d3d539b600fbdea00ee950352ac65cb773.jpg">
<meta property="article:published_time" content="2020-02-23T07:09:21.000Z">
<meta property="article:modified_time" content="2020-03-24T14:15:05.640Z">
<meta property="article:author" content="Luwang">
<meta property="article:tag" content="wallleap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=46b93e4b7d1ed21b79c929e39555baf9/14ce36d3d539b600fbdea00ee950352ac65cb773.jpg">


<link rel="icon" href="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/favicon.ico">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/sublime.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css" rel="stylesheet">
<link href="//cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css" rel="stylesheet">

<script src="//cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/customize.css">
<link rel="stylesheet" href="/css/github-badge.css">

<link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/honjun/hexo-tag-emojis-byhj/css/emoji.css">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
	.pace .pace-progress {  background: rgb(251, 129, 30); /*进度条颜色*/
	height: 3px;  }
	.pace .pace-progress-inner {  box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
	}
	.pace .pace-activity {  border-top-color: rgb(251, 129, 30);    /*上边框颜色*/
	border-left-color: rgb(251, 129, 30);    /*左边框颜色*/
	}
</style>

  

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b19f0ec10bac681106907eb1ee978d34";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>
  <!-- site-verification -->
  <meta name="google-site-verification" content="ZT29P3khtw1qk30lwEOdMqAGXvN3HGllzjzbB5Wln4k" />
  <meta name="baidu-site-verification" content="AQqaOCFUn0" />
  <meta name="360-site-verification" content="e9f3f65ff40b09c81ba47287a55363cd" />
  <meta name="sogou_site_verification" content="jAPTO5JOth"/>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-151908301-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-151908301-1');
  </script>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="wallleap" type="application/atom+xml">
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="false" />
</div>


<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/avatar.jpg" />
</a>
<div class="author">
    <span>Luwang</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"></use>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/wallleap" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
        <a title="weibo" href="http://weibo.com/u/6023739034" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-weibo"></use>
                </svg>
            
        </a>
        
    
        
        <a title="jianshu" href="https://www.jianshu.com/u/9357dd145d53" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-jianshu"></use>
                </svg>
            
        </a>
        
    
        
        <a title="zhihu" href="https://www.zhihu.com/people/8afbefe61c28c0fafed189b234afc91d" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-zhihu"></use>
                </svg>
            
        </a>
        
    
        
        <a title="csdn" href="https://me.csdn.net/qq_36949103" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-csdn"></use>
                </svg>
            
        </a>
        
    
        
    
        
        <a title="email" href="mailto:15579576761@163.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=990083804&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
        <a title="kugou" href="https://www.kugou.com/" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-kugou"></use>
                </svg>
            
        </a>
        
    
        
        <a title="neteasemusic" href="https://music.163.com/#/user/home?id=453867086" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-neteasemusic"></use>
                </svg>
            
        </a>
        
    
</div>




<ul>
    <li><div class="all active" data-rel="全部文章">全部文章<small>(53)</small></div></li>
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="博客"><i class="fold iconfont icon-right"></i>博客<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="博客<--->valine">valine<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="电脑"><i class="fold iconfont icon-right"></i>电脑<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="电脑<--->Win10">Win10<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="笔记"><i class="fold iconfont icon-right"></i>笔记<small>(28)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="笔记<--->后端">后端<small>(2)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->Hexo">Hexo<small>(8)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->Markdown">Markdown<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->五笔学习">五笔学习<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->前端">前端<small>(13)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->微信">微信<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->转载">转载<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="笔记<--->黑苹果">黑苹果<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="编程"><i class="fold iconfont icon-right"></i>编程<small>(2)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="编程<--->数据结构">数据结构<small>(2)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="网络"><i class="fold iconfont icon-right"></i>网络<small>(15)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="网络<--->HCNA">HCNA<small>(4)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="网络<--->华三">华三<small>(4)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="网络<--->基础">基础<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="资源"><i class="fold iconfont icon-right"></i>资源<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="资源<--->图集">图集<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
            <li><div data-rel="转载"><i class="fold iconfont icon-right"></i>转载<small>(2)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="转载<--->主题">主题<small>(2)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="阅读">阅读<small>(1)</small></div>
                
            </li>
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="53">
<input type="hidden" id="yelog_site_word_count" value="274.5k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
            <li><a target="_blank" href="https://www.zh66.club">皮皮家园</a></li>
            
            <li><a target="_blank" href="https://jwmm.xyz/">喵喵喵~</a></li>
            
            <li><a target="_blank" href="https://evrstr.tk/">evrStr</a></li>
            
            <li><a target="_blank" href="https://leeyiding.com/">LeeYD</a></li>
            
            <li><a target="_blank" href="https://cndrew.cn/">Uncle_drew</a></li>
            
            <li><a target="_blank" href="https://yremp.live/">Yremp</a></li>
            
            <li><a target="_blank" href="https://immmmm.com/">木木木木木</a></li>
            
            <li><a target="_blank" href="https://you.ci/">有次博客</a></li>
            
            <li><a target="_blank" href="https://www.fezhu.top/">Uncleacc</a></li>
            
            <li><a target="_blank" href="https://nateshao.gitee.io/">千羽</a></li>
            
            <li><a target="_blank" href="https://chanshiyu.com/">蝉时雨</a></li>
            
            <li><a target="_blank" href="https://www.antmoe.com/">小康博客</a></li>
            
            <li><a target="_blank" href="https://www.lete114.top/">Lete乐特</a></li>
            
            <li><a target="_blank" href="/">等待收录中……</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" />
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ACL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Ajax</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>AngularJS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Blog</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>C/C++</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CSS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>eNsp</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>eNSP</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ES</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Git</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>GitHub</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hackintosh</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HCL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HCNA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hexo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Hexo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HTML</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JavaScript</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jQuery</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Markdown</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MongoDB</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NAT</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NodeJS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OSPF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>React</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RIP</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Sakura</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>STP</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Ubuntu</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>VLAN</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Vue</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>w650dc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>web</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Win10</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>主题</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>五笔</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>交换机</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>企业网</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>前端</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>华三</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>博客</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>后端</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>图集</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>安装</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>实验</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>微信</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>微信防盗链</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>悦读</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>技术</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>数据结构</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>框架</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>模块化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>考研</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>英语</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>逆水寒</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>配置</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>黑苹果</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a id="top" class="全部文章 笔记 黑苹果 "
           href="/2019/03/14/w650dc-hackintosh/"
           data-tag="w650dc,hackintosh,黑苹果"
           data-author="" >
            <span class="post-title" title="毁灭者DC W650DC装黑苹果心得">毁灭者DC W650DC装黑苹果心得</span>
            <span class="post-date" title="2019-03-14 21:27:46">2019/03/14</span>
        </a>
        
        <a id="top" class="全部文章 网络 "
           href="/2019/09/30/web-HCL9/"
           data-tag="eNSP,企业网"
           data-author="" >
            <span class="post-title" title="使用eNSP搭建企业网络">使用eNSP搭建企业网络</span>
            <span class="post-date" title="2019-09-30 07:58:17">2019/09/30</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/08/28/VUE/"
           data-tag="前端,web,JavaScript,Vue"
           data-author="" >
            <span class="post-title" title="Vue学习笔记">Vue学习笔记</span>
            <span class="post-date" title="2020-08-28 12:33:14">2020/08/28</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/08/20/AJAX/"
           data-tag="前端,web,Ajax"
           data-author="" >
            <span class="post-title" title="Ajax学习笔记">Ajax学习笔记</span>
            <span class="post-date" title="2020-08-20 12:33:14">2020/08/20</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/07/12/React/"
           data-tag="前端,框架,React"
           data-author="" >
            <span class="post-title" title="React全家桶(技术栈)学习笔记">React全家桶(技术栈)学习笔记</span>
            <span class="post-date" title="2020-07-12 16:54:50">2020/07/12</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/07/04/Git/"
           data-tag="前端,Git"
           data-author="" >
            <span class="post-title" title="Git学习笔记">Git学习笔记</span>
            <span class="post-date" title="2020-07-04 23:33:49">2020/07/04</span>
        </a>
        
        <a  class="全部文章 笔记 后端 "
           href="/2020/06/14/nodejs/"
           data-tag="后端,NodeJS"
           data-author="" >
            <span class="post-title" title="NodeJs学习笔记">NodeJs学习笔记</span>
            <span class="post-date" title="2020-06-14 11:33:49">2020/06/14</span>
        </a>
        
        <a  class="全部文章 笔记 后端 "
           href="/2020/06/14/MongoDB/"
           data-tag="后端,MongoDB"
           data-author="" >
            <span class="post-title" title="MongoDB学习笔记">MongoDB学习笔记</span>
            <span class="post-date" title="2020-06-14 11:22:00">2020/06/14</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/06/04/AngularJs/"
           data-tag="前端,AngularJS"
           data-author="" >
            <span class="post-title" title="AngularJs学习笔记">AngularJs学习笔记</span>
            <span class="post-date" title="2020-06-04 23:33:49">2020/06/04</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/06/04/ES/"
           data-tag="前端,ES,模块化"
           data-author="" >
            <span class="post-title" title="ES和模块化学习笔记">ES和模块化学习笔记</span>
            <span class="post-date" title="2020-06-04 23:33:49">2020/06/04</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/04/26/jQuery/"
           data-tag="前端,web,JavaScript,jQuery"
           data-author="" >
            <span class="post-title" title="jQuery学习笔记">jQuery学习笔记</span>
            <span class="post-date" title="2020-04-26 20:33:14">2020/04/26</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/04/15/JavaScriptAdvance/"
           data-tag="前端,web,JavaScript"
           data-author="" >
            <span class="post-title" title="JavaScript高级学习笔记">JavaScript高级学习笔记</span>
            <span class="post-date" title="2020-04-15 19:33:14">2020/04/15</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/04/05/JavaScriptBase/"
           data-tag="前端,web,JavaScript"
           data-author="" >
            <span class="post-title" title="JavaScript基础学习笔记">JavaScript基础学习笔记</span>
            <span class="post-date" title="2020-04-05 12:33:14">2020/04/05</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/03/30/css/"
           data-tag="前端,web,CSS"
           data-author="" >
            <span class="post-title" title="CSS学习笔记">CSS学习笔记</span>
            <span class="post-date" title="2020-03-30 12:33:14">2020/03/30</span>
        </a>
        
        <a  class="全部文章 博客 valine "
           href="/2020/03/30/hexoValine/"
           data-tag="hexo"
           data-author="" >
            <span class="post-title" title="valine评论系统使用">valine评论系统使用</span>
            <span class="post-date" title="2020-03-30 12:16:01">2020/03/30</span>
        </a>
        
        <a  class="全部文章 笔记 Markdown "
           href="/2020/03/29/markdown/"
           data-tag="Markdown"
           data-author="" >
            <span class="post-title" title="Markdown语法大全">Markdown语法大全</span>
            <span class="post-date" title="2020-03-29 22:23:57">2020/03/29</span>
        </a>
        
        <a  class="全部文章 笔记 微信 "
           href="/2020/03/27/wechatpaper/"
           data-tag="微信"
           data-author="" >
            <span class="post-title" title="使用Markdown Here对微信公众号文章进行排版">使用Markdown Here对微信公众号文章进行排版</span>
            <span class="post-date" title="2020-03-27 22:36:35">2020/03/27</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/03/27/html/"
           data-tag="前端,web,HTML"
           data-author="" >
            <span class="post-title" title="HTML学习笔记">HTML学习笔记</span>
            <span class="post-date" title="2020-03-27 17:33:14">2020/03/27</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/03/24/chrometwo/"
           data-tag="前端,web"
           data-author="" >
            <span class="post-title" title="怎样拥有两个独立的Chrome">怎样拥有两个独立的Chrome</span>
            <span class="post-date" title="2020-03-24 10:33:14">2020/03/24</span>
        </a>
        
        <a  class="全部文章 笔记 前端 "
           href="/2020/03/24/webBase/"
           data-tag="前端,web"
           data-author="" >
            <span class="post-title" title="web入门基础知识">web入门基础知识</span>
            <span class="post-date" title="2020-03-24 10:33:14">2020/03/24</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2020/03/08/theme-beautify/"
           data-tag="主题,Hexo,Blog,博客"
           data-author="" >
            <span class="post-title" title="Sakura美化">Sakura美化</span>
            <span class="post-date" title="2020-03-08 21:09:24">2020/03/08</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2020/03/08/hexo-themes/"
           data-tag="Hexo,Blog,博客,Sakura"
           data-author="" >
            <span class="post-title" title="hexo博客如何更换主题，并且进行常用的配置">hexo博客如何更换主题，并且进行常用的配置</span>
            <span class="post-date" title="2020-03-08 13:31:00">2020/03/08</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2020/03/07/wechat-pic/"
           data-tag="Hexo,Blog,博客,微信防盗链"
           data-author="" >
            <span class="post-title" title="微信公众号图片防盗链破解">微信公众号图片防盗链破解</span>
            <span class="post-date" title="2020-03-07 23:50:00">2020/03/07</span>
        </a>
        
        <a  class="全部文章 "
           href="/2020/03/07/mindmaptest/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="测试思维导图">测试思维导图</span>
            <span class="post-date" title="2020-03-07 20:15:12">2020/03/07</span>
        </a>
        
        <a  class="全部文章 网络 HCNA "
           href="/2020/03/07/hcna-vlan/"
           data-tag="HCNA,VLAN"
           data-author="" >
            <span class="post-title" title="HCNA学习——VLAN配置">HCNA学习——VLAN配置</span>
            <span class="post-date" title="2020-03-07 00:54:04">2020/03/07</span>
        </a>
        
        <a  class="全部文章 笔记 五笔学习 "
           href="/2020/03/04/wubi/"
           data-tag="五笔"
           data-author="" >
            <span class="post-title" title="五笔学习笔记">五笔学习笔记</span>
            <span class="post-date" title="2020-03-04 23:33:49">2020/03/04</span>
        </a>
        
        <a  class="全部文章 网络 HCNA "
           href="/2020/03/02/switchbase/"
           data-tag="HCNA,交换机"
           data-author="" >
            <span class="post-title" title="HCNA学习——交换机基础配置">HCNA学习——交换机基础配置</span>
            <span class="post-date" title="2020-03-02 23:19:15">2020/03/02</span>
        </a>
        
        <a  class="全部文章 网络 基础 "
           href="/2020/02/29/networkmodule/"
           data-tag="HCNA"
           data-author="" >
            <span class="post-title" title="两种主要的网络参考模型">两种主要的网络参考模型</span>
            <span class="post-date" title="2020-02-29 19:53:49">2020/02/29</span>
        </a>
        
        <a  class="全部文章 网络 HCNA "
           href="/2020/02/24/eNSP-use/"
           data-tag="HCNA,eNSP"
           data-author="" >
            <span class="post-title" title="eNSP使用">eNSP使用</span>
            <span class="post-date" title="2020-02-24 21:39:54">2020/02/24</span>
        </a>
        
        <a  class="全部文章 网络 HCNA "
           href="/2020/02/22/eNSP-install/"
           data-tag="HCNA,eNSP"
           data-author="" >
            <span class="post-title" title="安装华为模拟器eNSP">安装华为模拟器eNSP</span>
            <span class="post-date" title="2020-02-22 21:39:56">2020/02/22</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2020/02/08/hexo-blog/"
           data-tag="Hexo,GitHub,Blog,博客"
           data-author="" >
            <span class="post-title" title="闲着也是闲着，不如搭个免费的博客玩玩">闲着也是闲着，不如搭个免费的博客玩玩</span>
            <span class="post-date" title="2020-02-08 21:34:47">2020/02/08</span>
        </a>
        
        <a  class="全部文章 转载 主题 "
           href="/2020/02/04/hexotheme/"
           data-tag="主题"
           data-author="" >
            <span class="post-title" title="都2020了，带你开发hexo主题">都2020了，带你开发hexo主题</span>
            <span class="post-date" title="2020-02-04 22:16:01">2020/02/04</span>
        </a>
        
        <a  class="全部文章 电脑 Win10 "
           href="/2019/11/07/WLU/"
           data-tag="Win10,Ubuntu"
           data-author="" >
            <span class="post-title" title="Win10启用其子系统Ubuntu并安装图形界面">Win10启用其子系统Ubuntu并安装图形界面</span>
            <span class="post-date" title="2019-11-07 10:21:17">2019/11/07</span>
        </a>
        
        <a  class="全部文章 笔记 转载 "
           href="/2019/10/31/English_ReadWay/"
           data-tag="考研,英语"
           data-author="" >
            <span class="post-title" title="唐迟阅读方法论">唐迟阅读方法论</span>
            <span class="post-date" title="2019-10-31 21:58:17">2019/10/31</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2019/09/27/web-HCL8/"
           data-tag="eNSP,ACL,NAT"
           data-author="" >
            <span class="post-title" title="ACL+NAT配置">ACL+NAT配置</span>
            <span class="post-date" title="2019-09-27 07:58:17">2019/09/27</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2019/09/27/web-HCL7/"
           data-tag="eNSP,OSPF"
           data-author="" >
            <span class="post-title" title="OSPF配置">OSPF配置</span>
            <span class="post-date" title="2019-09-27 07:58:04">2019/09/27</span>
        </a>
        
        <a  class="全部文章 资源 图集 "
           href="/2019/09/20/atlas1/"
           data-tag="逆水寒,图集"
           data-author="" >
            <span class="post-title" title="图集1-逆水寒">图集1-逆水寒</span>
            <span class="post-date" title="2019-09-20 20:15:12">2019/09/20</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2019/09/19/web-HCL6/"
           data-tag="eNsp,RIP"
           data-author="" >
            <span class="post-title" title="RIP配置">RIP配置</span>
            <span class="post-date" title="2019-09-19 16:13:56">2019/09/19</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2019/09/18/web-HCL4/"
           data-tag="HCL,华三"
           data-author="" >
            <span class="post-title" title="DHCP配置(续)--DHCP中继">DHCP配置(续)--DHCP中继</span>
            <span class="post-date" title="2019-09-18 16:14:16">2019/09/18</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2019/09/18/web-HCL5/"
           data-tag="eNsp,STP"
           data-author="" >
            <span class="post-title" title="STP及VRRP配置">STP及VRRP配置</span>
            <span class="post-date" title="2019-09-18 16:13:56">2019/09/18</span>
        </a>
        
        <a  class="全部文章 阅读 "
           href="/2019/09/15/book1/"
           data-tag="悦读"
           data-author="" >
            <span class="post-title" title="书单1--平凡的世界">书单1--平凡的世界</span>
            <span class="post-date" title="2019-09-15 19:32:39">2019/09/15</span>
        </a>
        
        <a  class="全部文章 网络 华三 "
           href="/2019/09/12/web-HCL3/"
           data-tag="HCL,华三,实验,配置"
           data-author="" >
            <span class="post-title" title="HCL配置(三)–-DHCP配置">HCL配置(三)–-DHCP配置</span>
            <span class="post-date" title="2019-09-12 15:42:43">2019/09/12</span>
        </a>
        
        <a  class="全部文章 网络 华三 "
           href="/2019/09/11/web-HCL2/"
           data-tag="HCL,华三,实验,配置"
           data-author="" >
            <span class="post-title" title="HCL配置(二)--VLAN间通信">HCL配置(二)--VLAN间通信</span>
            <span class="post-date" title="2019-09-11 18:06:05">2019/09/11</span>
        </a>
        
        <a  class="全部文章 网络 华三 "
           href="/2019/09/09/web-HCL1/"
           data-tag="HCL,华三,实验,配置"
           data-author="" >
            <span class="post-title" title="HCL配置(一)--ping通及Telnet">HCL配置(一)--ping通及Telnet</span>
            <span class="post-date" title="2019-09-09 21:54:19">2019/09/09</span>
        </a>
        
        <a  class="全部文章 网络 华三 "
           href="/2019/09/09/web-HCL0/"
           data-tag="HCL,华三,安装"
           data-author="" >
            <span class="post-title" title="HCL的安装和使用">HCL的安装和使用</span>
            <span class="post-date" title="2019-09-09 21:34:37">2019/09/09</span>
        </a>
        
        <a  class="全部文章 编程 数据结构 "
           href="/2019/08/28/DataStructure1/"
           data-tag="数据结构,C/C++,技术"
           data-author="" >
            <span class="post-title" title="数据结构(1)-绪论">数据结构(1)-绪论</span>
            <span class="post-date" title="2019-08-28 22:12:47">2019/08/28</span>
        </a>
        
        <a  class="全部文章 编程 数据结构 "
           href="/2019/08/25/DataStructure0/"
           data-tag="数据结构,C/C++"
           data-author="" >
            <span class="post-title" title="数据结构(0)--预备知识">数据结构(0)--预备知识</span>
            <span class="post-date" title="2019-08-25 10:18:51">2019/08/25</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2019/08/25/mac-blog4/"
           data-tag="Hexo,GitHub,Blog,博客"
           data-author="" >
            <span class="post-title" title="Mac使用Hexo和GitHub搭建博客(4)--博客维护">Mac使用Hexo和GitHub搭建博客(4)--博客维护</span>
            <span class="post-date" title="2019-08-25 09:30:28">2019/08/25</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2019/08/25/mac-blog3/"
           data-tag="Hexo,GitHub,Blog,博客"
           data-author="" >
            <span class="post-title" title="Mac使用Hexo和GitHub搭建博客(3)--发布文章">Mac使用Hexo和GitHub搭建博客(3)--发布文章</span>
            <span class="post-date" title="2019-08-25 08:46:41">2019/08/25</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2019/08/24/mac-blog2/"
           data-tag="Hexo,GitHub,Blog,博客"
           data-author="" >
            <span class="post-title" title="Mac使用Hexo和GitHub搭建博客(2)--优化配置">Mac使用Hexo和GitHub搭建博客(2)--优化配置</span>
            <span class="post-date" title="2019-08-24 20:21:59">2019/08/24</span>
        </a>
        
        <a  class="全部文章 笔记 Hexo "
           href="/2019/08/24/mac-blog1/"
           data-tag="Hexo,GitHub,Blog,博客"
           data-author="" >
            <span class="post-title" title="Mac使用Hexo和GitHub搭建博客(1)--搭建博客">Mac使用Hexo和GitHub搭建博客(1)--搭建博客</span>
            <span class="post-date" title="2019-08-24 20:14:35">2019/08/24</span>
        </a>
        
        <a  class="全部文章 "
           href="/2019/08/08/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2019-08-08 19:32:39">2019/08/08</span>
        </a>
        
        <a  class="全部文章 转载 主题 "
           href="/2018/12/12/Hexo-Theme-Sakura/"
           data-tag="主题"
           data-author="" >
            <span class="post-title" title="Hexo-Theme-Sakura">Hexo-Theme-Sakura</span>
            <span class="post-date" title="2018-12-12 22:16:01">2018/12/12</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-AJAX" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Ajax学习笔记</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="笔记">笔记</a> > 
            
            <a  data-rel="笔记&lt;---&gt;前端">前端</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">前端</a>
            
            <a class="color4">web</a>
            
            <a class="color5">Ajax</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2020-09-11 21:49:36'>2020-08-20 12:33</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:11.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">一、概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">二、快速上手</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1、AJAX基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">2、理解readyState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3、AJAX遵循HTTP协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">三、具体用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1、数据接口的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">2、AJAX发送GET请求并传递参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3、POST请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">4、同步和异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">5、响应数据格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">6、处理服务器端响应的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">7、兼容方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">8、补充</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">四、封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1、AJAX请求封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">2、jQuery中的Ajax</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3、axios</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">4、fetch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">五、跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1、概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">2、解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">六、XMLHttpRequest2.0</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-4 i,
    .toc-level-4 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="一-概述">一、概述</span></h2><blockquote>
<p>Web程序的最初的目的就是将信息(数据)放到公共的服务器，让所有的网络用户都可以通过浏览器访问</p>
</blockquote>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815183452.png" alt="image-20200815183450778"></p>
<p>在此之前，我们可以通过以下几种方式让浏览器发出服务端的请求，获得服务端的数据：</p>
<ul>
<li><p>地址栏输入地址，回车，刷新</p>
</li>
<li><p>特定元素的href或src属性</p>
</li>
<li><p>表单提交</p>
</li>
</ul>
<p>这些方案都是我们无法通过或者很难通过代码的方式进行编程(对服务器发出请求并且接收服务端返回的响应)，如果我们可以通过JavaScript直接发送网络请求，那么web的可能就会更多，随之能够实现的功能也会更多，至少不再是“单机游戏”。</p>
<p>1、AJAX(Asynchronous JavaScript and XML,异步的JS和XML)，最早出现在2005年的Google Suggest，是在浏览器端进行网络编程(发送请求，接收响应)的技术方案，它使我们可以<strong>通过JavaScript直接获取服务端最新的内容而不必重新加载页面</strong>，让web更能接近桌面应用的用户体验。</p>
<p>说白了，AJAX就是<strong>浏览器提供的一套API</strong>，可以通过JavaScript调用，从而实现代码控制请求与响应，实现网络编程。(AJAX不是新的编程语言，而是一种将现有标准组合在一起使用的新的方式)</p>
<blockquote>
<p>能力不够API凑。</p>
</blockquote>
<blockquote>
<p>对xxx进行编程指的就是用代码的方式操作它</p>
</blockquote>
<p>2、XML</p>
<p>可扩展标记语言，被设计用来传输和存储数据，和HTML有点像，但是HTML中都是预定义标签，而XML中没有预定义标签，全都是自定义标签，用来表示一些数据。</p>
<p>现在已经被json取代了。</p>
<p>3、AJAX的特点</p>
<p>(1) 优点</p>
<p>可以无需刷新页面而与服务器端进行通信。</p>
<p>允许你根据用户事件来更新部分页面内容。</p>
<p>(2) 缺点</p>
<p>没有浏览历史，不能回退</p>
<p>存在跨域问题(同源)</p>
<p>SEO不友好</p>
<p>补充：搭建环境</p>
<p><strong>使用Express搭建后台</strong></p>
<p><a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener">Express中文网</a></p>
<p>1、安装</p>
<p>需要有node，没有的可以先<a href="https://nodejs.org/en/" target="_blank" rel="noopener">下载</a></p>
<p>进入一个文件夹，输入命令创建node应用</p>
<pre><code class="bash">npm init --yes</code></pre>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/image-20200810090417637.png" alt="node初始化命令"></p>
<p>接着输入命令，安装express</p>
<pre><code class="bash">npm install express</code></pre>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/image-20200810090617412.png" alt="express安装"></p>
<p>2、基本使用</p>
<p>(1) 编写代码</p>
<pre><code class="javascript">// 1、引入express
const express = require(&#39;express&#39;)
const { response } = require(&#39;express&#39;)

// 2、创建应用对象
const app = express()

// 3、创建路由规则 
// reques是对请求报文的封装；response是对响应报文的封装
app.get(&#39;/&#39;, (request, response) =&gt; { // 前端访问http://localhost:8000/
  // 设置响应
  response.send(&#39;Hello Express&#39;)
})

// 4、监听端口启动服务
app.listen(8000, () =&gt; {
  console.log(&#39;服务已经启动，8000端口监听中，请访问http://localhost:8000/&#39;)
})</code></pre>
<p>(2) 运行代码</p>
<p>在该目录下输入命令</p>
<pre><code class="bash">node 文件名.js</code></pre>
<p>eg:</p>
<pre><code class="bash">node expressTest.js</code></pre>
<p>接着访问地址<a href="http://localhost:8000/即可" target="_blank" rel="noopener">http://localhost:8000/即可</a></p>
<p>3、准备服务端代码</p>
<p><code>server.js</code></p>
<pre><code class="javascript">const express = require(&#39;express&#39;)
const { response } = require(&#39;express&#39;)
const app = express()
// 这里设置为get则请求方式为GET、&#39;/server&#39;则请求url需要加上这个
app.get(&#39;/server&#39;, (request, response) =&gt; {
  // 设置响应头
  response.setHeader(&#39;Access-Control-Allow-origin&#39;,&#39;*&#39;) // 设置允许跨域
  // 设置响应体
  response.send(&#39;Hello AJAX&#39;)
})
// 在这里接着加上接口
app.listen(8000, () =&gt; {
  console.log(&#39;服务已经启动，8000端口监听中，请访问http://localhost:8000/&#39;)
})</code></pre>
<p>关闭上面那个，将这个启动：</p>
<pre><code class="bash">node server.js</code></pre>
<p>reload包——nodemon</p>
<p>自动检测js代码变化，restart服务</p>
<p>1、安装</p>
<pre><code class="sh">npm install -g nodemon</code></pre>
<p>2、利用nodemon执行文件</p>
<pre><code class="sh">nodemon 文件名.js</code></pre>
<p>例如：</p>
<pre><code class="sh">nodemon server.js</code></pre>
<h2><span id="二-快速上手">二、快速上手</span></h2><h3><span id="1-ajax基础">1、AJAX基础</span></h3><p>(一个构造函数、两个方法、一个事件)</p>
<p>发送请求</p>
<pre><code class="html">&lt;style&gt;
#result{
    width:200px;
    height:100px;
    border:1px solid skyblue;
}
&lt;/style&gt;
&lt;button id=&quot;btn&quot;&gt;点击发送请求&lt;/button&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
btn.onclick = function(){
  // 涉及到AJAX操作的页面不能使用文件协议访问（文件的方式访问）
  // AJAX是一套API，核心提供的类型：XMLHttpRequest XML--&gt;JSON(现在使用的是JSON格式的了)
  // 1、安装浏览器（用户代理）——创建对象
  var xhr = new XMLHttpRequest() // xhr就类似于浏览器的作用(发送请求接收响应)
  // 2、打开浏览器 输入网址——初始化 设置请求方式和url
  xhr.open(&#39;GET&#39;, &#39;http://127.0.0.1:8000/server&#39;)  // 这一步只是在搭桥铺路
  // 3、敲回车键 开始请求——发送
  xhr.send()  // send才是开始请求
  /* 上面三个是ajax核心代码 */
}
&lt;/script&gt;</code></pre>
<p>接收响应</p>
<pre><code class="html">&lt;script&gt;
  var xhr = new XMLHttpRequest()
  xhr.open(&#39;GET&#39;, &#39;http://127.0.0.1:8000/server&#39;) // 方式，url
  xhr.send()
  /* 因为响应需要时间，所以无法通过返回值的方式返回响应 */
  // var response = xhr.send()
  // console.log(response) // undefine

  // 4、等待响应——事件绑定 处理服务端返回的结果
  /* 如果需要捕获状态的变化，需要注意代码的执行顺序的问题(不要出现来不及的情况)
  * 因为客户端永远不知道服务端何时才能返回我们需要的响应，所以AJAX API采用事件的机制(通知的感觉)
  */
  xhr.onreadystatechange = function(){ // 建议事件使用addEventListener方式
    // 这个事件并不是只在响应时触发，XHR状态改变就触发
    console.log(this.readyState)
    if(this.readyState!==4) return
    // 所以下面就是为4的情况
    // 5、看结果
    console.log(this.responseText) // 获取响应内容(响应体)
    result.innerHTML = xhr.response
  }
&lt;/script&gt;</code></pre>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815183735.png" alt="ajax基础操作"></p>
<h3><span id="2-理解readystate">2、理解readyState</span></h3><p><code>onreadystatechange</code>是XHR状态改变时触发的</p>
<pre><code class="html">&lt;script&gt;
  var xhr = new XMLHttpRequest()
  console.log(xhr.readyState) // 0
  xhr.open(&#39;GET&#39;, &#39;./time.php&#39;)
  console.log(xhr.readyState) // 1
  xhr.send()
  // console.log(xhr.readyState) // 1 取上面那个
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    // if(this.readyState !== 4) return
    // console.log(this.responseText)
    console.log(this.readyState) // 2 3 4
  })
&lt;/script&gt;</code></pre>
<p>readyState：</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815183844.png" alt="readyState代码"></p>
<p>new XMLHttpRequest –&gt; 0 初始化 <strong>请求代理对象</strong></p>
<p>1–-&gt; open方法已经调用，<strong>建立</strong>一个与服务端特定端口的<strong>连接</strong></p>
<p>2 –-&gt; 已经<strong>接收</strong>到了响应报文的<strong>响应头</strong> <code>console.log(this.getAllResponseHeaders())</code> 可以拿到响应头，拿不到响应体</p>
<p>拆分：<code>console.log(this.getAllResponseHeaders().splite(‘\n’).splite(‘:’))</code></p>
<p>获取指定键：<code>console.log(this.getAllResponseHeaders(‘data’))</code></p>
<p>3 –-&gt; <strong>正在下载响应报文的响应体</strong>，可能响应体为空或不完整</p>
<p>4 –-&gt; 一切OK，<strong>整个响应报文已经下载下来</strong>了 <code>console.log(this.responseText)</code></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815183915.png" alt="readyState"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815183935.png" alt="image-20200815183934889"></p>
<p>所以应该<strong>在readyState的值为4</strong>时，才去处理后续的逻辑</p>
<p>可以用<code>xhr.onload</code>替代</p>
<pre><code class="html">&lt;script&gt;
  var xhr = new XMLHttpRequest()
  xhr.open(&#39;GET&#39;, &#39;time.php&#39;)
  xhr.send(null) // send可以传请求体，传null代表没有请求体
  xhr.onload = function (){ // 加载完成 H5中提供的XMLHttpRequest version 2.0定义的
    // 相当于readyState为4之后的
    console.log(this.responseText)
  }
&lt;/script&gt;</code></pre>
<p>ps: console.log(this) 显示readyState是2、3、4可展开来全都是4，这个是console.log的机制问题，展开的时候只会显示此时的状态</p>
<p>例如：</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184045.png" alt="log机制测试"></p>
<p>在浏览器上看，不展开没问题显示123，展开的一瞬间都是456</p>
<h3><span id="3-ajax遵循http协议">3、AJAX遵循HTTP协议</span></h3><p>HTTP协议(Hypertext Transport Protocol，超文本传输协议)详细规定了浏览器和万维网服务器之间互相通信的规则。</p>
<p>本质上XMLHttpRequest就是JavaScript在web平台中发送HTTP请求的手段，所以我们发送出去的请求仍然是HTTP请求，同样符合HTTP约定的格式</p>
<p>请求报文：</p>
<ul>
<li>请求行 <code>POST /s?ie=utf-8 HTTP/1.1</code></li>
</ul>
<p>​    <code>GET /s?ie=utf-8 HTTP/1.1</code></p>
<ul>
<li>请求头 <code>Host: atguigu.com</code></li>
</ul>
<p>​    <code>Cookie: name=guigu</code></p>
<p>​    <code>Content-Type: application/x-www-form-urlencoded</code></p>
<p>​    <code>User-Agent: chrome 83</code></p>
<ul>
<li><p>空行(必须得有)</p>
</li>
<li><p>请求体 (GET请求这里为空，POST可不为空) <code>username=admin&amp;password=admin</code></p>
</li>
</ul>
<p>响应报文：</p>
<ul>
<li>行  <code>HTTP/1.1 200 OK</code></li>
</ul>
<p>​       404</p>
<p>​       403</p>
<p>​       401</p>
<p>​       500</p>
<ul>
<li><p>头  <code>Content-Type: text/html;charset=utf-8</code></p>
<p> <code>Content-length: 2048</code></p>
<p> <code>Content-encoding: gzip</code></p>
</li>
<li><p>空行 </p>
</li>
<li><p>体  </p>
</li>
</ul>
<pre><code>&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;wallleap&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre><p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184354.png" alt="HTTP响应报文信息"></p>
<pre><code class="html">&lt;script&gt;
  // 1、创建对象
  var xhr = new XMLHttpRequest()
  // 2、初始化 设置请求方法和url
xhr.open(&#39;POST&#39;, &#39;add.php&#39;) // 设置请求行
  xhr.setRequestHeader(&#39;Foo&#39;, &#39;Bar&#39;) // 设置一个请求头
  // 一旦请求体是urlencoded格式的内容，一定要设置请求头中的Content-Type为下面这个
  xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;) // 设置第二请求头
  xhr.send(&#39;key1=value1&amp;key2=value2&#39;) // 以urlencoded格式设置请求体
  // xhr.send(&#39;{&quot;foo&quot;: &quot;123&quot;}&#39;) // 以json格式设置请求体，上面设置application/json
  xhr.onload = function (){
    // 响应行
    console.log(this.status) // 获取响应状态码
    console.log(this.statusText) // 获取响应状态描述
    // 获取响应头信息
    console.log(this.getResponseHeader(&#39;Content-Type&#39;)) // 指定响应头
    console.log(this.getAllResponseHeaders()) // 全部响应头
    // 获取响应体
    console.log(this.responseText) // 文本形式
    console.log(this.responseXML) // XML形式，了解即可
  }
&lt;/script&gt;</code></pre>
<p>补充：</p>
<pre><code class="javascript">xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState === 4 &amp;&amp; this.status === 200){
      console.log(this)
    }
})</code></pre>
<p>可能有的人会同时判断状态码200，事实上没有必要，状态码404也需要处理,可以到里面嵌套，例如：</p>
<pre><code class="javascript">xhr.onreadystatechange=function(){
  if(this.readyState === 4){
    if(this.status &gt;= 200  &amp;&amp; xhr.status &lt; 300){
      // 处理结果
    }else{
      ...
    }
  }
})</code></pre>
<p>Chrome打开开发者模式</p>
<p>点击Network能够看到传输的文件</p>
<p>点击XHR查看</p>
<p>Request Headers——请求头</p>
<p>点击view source可以看到请求行</p>
<p>Response Header——响应头</p>
<p>点击view source可以看到响应行</p>
<p>Response——响应体</p>
<p>Preview——预览，对响应体解析之后的页面</p>
<h2><span id="三-具体用法">三、具体用法</span></h2><h3><span id="1-数据接口的概念">1、数据接口的概念</span></h3><p>服务器端返回的响应就是一个JSON内容（返回的就是数据）</p>
<p>对于返回数据的地址一般我们称之为接口（形式上是web形式）</p>
<p><a href="http://api.douban.com/v2/movie/top250" target="_blank" rel="noopener">http://api.douban.com/v2/movie/top250</a></p>
<p>提供一定的能力，有输入有输出就可以称为接口</p>
<h3><span id="2-ajax发送get请求并传递参数">2、AJAX发送GET请求并传递参数</span></h3><pre><code class="html">&lt;script&gt;
  var xhr = new XMLHttpRequest()
  // GET请求传递参数通常使用URL中的问号传递数据
  xhr.open(&#39;GET&#39;, &#39;http://127.0.0.1:8000/server?a=100&amp;b=200&amp;c=300&#39;)
  // 一般在GET请求时无需设置响应体，可以传null或者干脆不传
  xhr.send(null)
  xhr.onreadystatechange = function (){
    if(this.readyState !== 4) return
    console.log(this.responseText)
  }
&lt;/script&gt;
&lt;!-- 一般情况下URL传递的都是参数性质的数据，而POST一般都是业务数据 --&gt;</code></pre>
<p>例子：将得到的四个用户名称{}放到ul&gt;li中，点击li能够获取到该用户的年龄</p>
<pre><code class="html">&lt;ul id=&quot;list&quot;&gt;&lt;/ul&gt;
&lt;script&gt;
  var listElement = document.getElementById(&#39;list&#39;)
  /* 发送请求获取到列表数据，呈现在页面上 */
  var xhr = new XMLHttpRequest()
  xhr.open(&#39;POST&#39;, &#39;user.php?id=2&#39;)
  xhr.send(null)
  xhr.onreadystatechange = function (){
    if(this.readyState !== 4) return
    var data = JSON.parse(this.responseText)
    // console.log(data)
    for(var i = 0; i &lt; data.length; i++){
      // console.log(data[i])
      var liElement = document.createElement(&#39;li&#39;)
      liElement.innerHTML = data[i].name
      liElement.id = data[i].id
      listElement.appendChild(liElement)
      /* 给每一个li注册点击事件 */
      // 由于li是动态创建的，因此需要移到创建li的时候
      listElement.addEventListener(&#39;click&#39;, function (){
          // TODO: 通过AJAX操作获取服务端对应数据的信息
          // 获取当前被点击元素对应数据的id
          // console.log(this.id)
          var xhr1 = new XMLHttpRequest()
          xhr1.open(&#39;GET&#39;, &#39;users.php?id=&#39; + this.id)
          xhr1.send()
          xhr1.onreadystatechange = function (){
            if(this.readyState !== 4) return
            var obj = JSON.parse(this.responseText)
            alert(obj.age)
          }
      })
    }
  }
&lt;/script&gt;</code></pre>
<h3><span id="3-post请求">3、POST请求</span></h3><p>POST请求过程中，都是采用请求体承载需要提交的数据</p>
<pre><code class="javascript">// 1.创建对象
const xhr = new XMLHttpRequest()
// 2.初始化 设置类型与URL(open的第一个参数的作用就是设置请求的method)
xhr.open(&#39;POST&#39;,&#39;http://127.0.0.1:8000/server&#39;)
// 设置请求头信息
xhr.setRequestHeader(&#39;Content-Type&#39;,&#39;application/x-www-form-urlencoded&#39;) // 设置请求头中的Content-Type为application/x-www-form-urlencoded——标识这次请求得请求体格式为urlencoded以便于服务端接收数据
// xhr.setRequestHeader(&#39;name&#39;,&#39;wallleap&#39;) // 也可以自定义
// 3.发送 POST方式需要提交到服务端的数据可以通过send方法的参数传递，格式：key1=value1&amp;key2=value2
xhr.send(&quot;key1=value1&amp;key2=value2&quot;)
// xhr.send(&quot;key1:value1&amp;key2:value2&quot;)
// xhr.send(&quot;value1&quot;)  // ---&gt;可以随意写，但是需要按格式，方便后台处理
// 4.事件绑定
xhr.onreadystatechange = function(){
  // 判断
  if(xhr.readyState===4){
    if(xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300){
      // 处理服务端返回的结果
      result.innerHTML = xhr.response
    }
  }
}</code></pre>
<p>由于<code>server.js</code>中只设置了get的允许跨域，因此需要在文件中加入允许post跨域的代码</p>
<pre><code class="javascript">// app.get(&#39;/server&#39;, (request, response) =&gt; {
app.post(&#39;/server&#39;, (request, response) =&gt; {
  // 设置响应头  设置允许跨域
  response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  // 设置允许所有头信息，就比如上面设置的自定义响应头会报错，就需要加上这个
  // response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
  // 设置响应体
  response.send(&#39;HELLO AJAX POST&#39;);
});</code></pre>
<p>可以改为all</p>
<pre><code class="javascript">//可以接收任意类型的请求(get/post/options/...)
app.all(&#39;/server&#39;, (request, response) =&gt; {
  //设置响应头  设置允许跨域
  response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  //响应头
  response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
  //设置响应体
  response.send(&#39;HELLO AJAX POST&#39;);
});</code></pre>
<p>测试</p>
<pre><code class="html">&lt;style&gt;
#result{
  width:200px;
  height:100px;
  border:solid 1px #903;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  //获取元素对象
  const result = document.getElementById(&quot;result&quot;);
  //绑定事件
  result.addEventListener(&quot;mouseover&quot;, function(){
    //1. 创建对象
    const xhr = new XMLHttpRequest();
    //2. 初始化 设置类型与 URL
    xhr.open(&#39;POST&#39;, &#39;http://127.0.0.1:8000/server&#39;);
    //设置请求头
    xhr.setRequestHeader(&#39;Content-Type&#39;,&#39;application/x-www-form-urlencoded&#39;);
    xhr.setRequestHeader(&#39;name&#39;,&#39;wallleap&#39;);
    //3. 发送
    xhr.send(&#39;a=100&amp;b=200&amp;c=300&#39;);
    // xhr.send(&#39;a:100&amp;b:200&amp;c:300&#39;);
    // xhr.send(&#39;1233211234567&#39;);
    //4. 事件绑定
    xhr.onreadystatechange = function(){
      //判断
      if(xhr.readyState === 4){
        if(xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300){
          //处理服务端返回的结果
          result.innerHTML = xhr.response;
        }
      }
    }
  });
&lt;/script&gt;</code></pre>
<p>例子：点击登录按钮不刷新页面将数据传到后台</p>
<pre><code class="html">&lt;style&gt;
.loading{
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #555;
  text-align: center;
  padding-top: 200px;
  opacity: .5;
}
.loading::after{
  content: &#39;加载中……&#39;;
  font-size: 60px;
  color: #fff;
}
&lt;/style&gt;
&lt;div class=&quot;loading&quot;&gt;&lt;/div&gt;
&lt;table border=&quot;1&quot;&gt;
  &lt;tr&gt;
    &lt;td&gt;用户名&lt;/td&gt;
    &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot; id=&quot;username&quot;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;密码&lt;/td&gt;
    &lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;&quot; id=&quot;password&quot;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;/td&gt;
    &lt;td&gt;&lt;button id=&quot;btn&quot;&gt;登录&lt;/button&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;script&gt;
  // 找一个合适的时机，做一件合适的事情(时间、内容)
  // 1、获取界面上的元素 value
  var textUsername = document.getElementById(&#39;username&#39;)
  var textPassword = document.getElementById(&#39;password&#39;)
  var btn = document.getElementById(&#39;btn&#39;)
  var loading = document.querySelector(&#39;.loading&#39;)
  btn.onclick = function (){
    loading.style.display = &#39;block&#39;
    var username = textUsername.value
    var password = textPassword.value
    // 2、通过XHR发送一个POST请求
    var xhr = new XMLHttpRequest
    xhr.open(&#39;POST&#39;, &#39;login.php&#39;)
    // 一定注意：如果请求体是urlencoded格式，必须设置这个请求头！
    xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;)
    // xhr.send(&#39;username=&#39; + username + &#39;&amp;password=&#39; + password)
    xhr.send(`username=${username}&amp;password=${password}`)
    // 3、根据服务端的反馈，作出界面提示
    xhr.onreadystatechange = function (){
      if(this.readyState !== 4) return
      console.log(this.responseText)
      loading.style.display = &#39;none&#39;
    }
  }
&lt;/script&gt;</code></pre>
<h3><span id="4-同步和异步">4、同步和异步</span></h3><p>生活中：</p>
<p>同步：一个人在同一个时刻只能做一件事情，在执行一些耗时的操作(不需要看管)不去做别的事情，只是等待</p>
<p>异步：在执行一些耗时的操作(不需要看管)去做别的事，而不是等待</p>
<p>xhr.open()第三个参数(async)要求传入的是一个bool值，其作用就是设置此次请求是否采用异步方式执行，默认为true，如果需要同步执行可以通过传递false实现</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184832.png" alt="image-20200815184831019"></p>
<p><code>console.time(‘标识’)</code> 启动一个秒表</p>
<p>中间写代码</p>
<p><code>console.timeEnd(‘标识’)</code> 结束这个秒表</p>
<p>这样就能知道用了多长时间(标识名称得相同)</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184906.png" alt="image-20200815184905369"></p>
<p>如果采用同步方式执行，则代码会卡死在xhr.send()这一步</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184921.png" alt="image-20200815184920339"></p>
<p>send方法会不会出现等待情况(区分同异步)</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184939.png" alt="image-20200815184938765"></p>
<p>知道同步模式即可(已被遗弃)</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815184956.png" alt="image-20200815184955646"></p>
<p>同步模式注册时间时机问题</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185018.png" alt="image-20200815185017871"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185029.png" alt="image-20200815185028276"></p>
<h3><span id="5-响应数据格式">5、响应数据格式</span></h3><p>如果希望服务器返回一个复杂数据，该如何处理：</p>
<p> 服务器发出何种格式的数据，这个格式如何在客户端用JavaScript解析</p>
<p>5.1 XML</p>
<p>一种数据描述手段</p>
<p>老掉牙的东西，现在项目中基本不使用</p>
<p>淘汰的原因：数据冗余太多</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185058.png" alt="image-20200815185057257"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185108.png" alt="image-20200815185106691"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185115.png" alt="image-20200815185114823"></p>
<p><strong>5.2 JSON</strong></p>
<p>也是一种数据描述手段，类似于JavaScript字面量方式</p>
<p>服务端采用JSON格式返回数据，客户端按照JSON格式解析数据</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185141.png" alt="image-20200815185140660"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185148.png" alt="image-20200815185147671"></p>
<p>来测试一下json的</p>
<p><code>server.js</code>中添加</p>
<pre><code class="javascript">//JSON 响应
app.all(&#39;/json-server&#39;, (request, response) =&gt; {
  //设置响应头  设置允许跨域
  response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  //响应头
  response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
  //响应一个数据
  const data = {
    name: &#39;wallleap&#39;
  };
  //对对象进行字符串转换
  let str = JSON.stringify(data);
  //设置响应体
  response.send(str);
});</code></pre>
<p>测试</p>
<pre><code class="html">&lt;style&gt;
  #result{
    width:200px;
    height:100px;
    border:solid 1px #89b;
  }
&lt;/style&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  //绑定键盘按下事件
  window.onkeydown = function(){
    //发送请求
    const xhr = new XMLHttpRequest();
    //设置响应体数据的类型
    xhr.responseType = &#39;json&#39;; // 自动转换
    //初始化
    xhr.open(&#39;GET&#39;,&#39;http://127.0.0.1:8000/json-server&#39;);
    //发送
    xhr.send();
    //事件绑定
    xhr.onreadystatechange = function(){
      if(xhr.readyState === 4){
        if(xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300){
          // console.log(xhr.response);
          // result.innerHTML = xhr.response;
          // 1. 手动对数据转化
          // let data = JSON.parse(xhr.response);
          // console.log(data);
          // result.innerHTML = data.name;
          // 2. 自动转换
          console.log(xhr.response);
          result.innerHTML = xhr.response.name;
        }
      }
    }
  }
&lt;/script&gt;</code></pre>
<p>注意：</p>
<p>不论是JSON，还是XML，只是在AJAX请求过程中用到，并不代表它们之间有必然的联系，它们只是数据协议罢了</p>
<p>不管服务器使用XML还是JSON本质上都是将数据返回给客户端</p>
<p>服务端应该设置一个合理的Content-Type</p>
<h3><span id="6-处理服务器端响应的数据">6、处理服务器端响应的数据</span></h3><p>动态渲染数据到表格中</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185218.png" alt="image-20200815185217284"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185226.png" alt="image-20200815185225225"></p>
<p>现在一般都不会这样操作，太繁琐了</p>
<p>模板引擎</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185252.png" alt="image-20200815185251189"></p>
<p>常见模板引擎列表：<a href="https://github.com/tj/consolidate.js#supported-template-engines" target="_blank" rel="noopener">https://github.com/tj/consolidate.js#supported-template-engines</a></p>
<p>artTemplate： <a href="https://aui.github.io/art-template" target="_blank" rel="noopener">https://aui.github.io/art-template</a></p>
<p>模板引擎实际上就是一个API，模板引擎有很多种，使用方式大同小异，目的为了可以更容易地将数据渲染到HTML中</p>
<pre><code class="html">&lt;table id=&quot;comment&quot; border=&quot;1&quot;&gt;&lt;/table&gt;
&lt;!-- // 1.选择一个模板引擎 https://github.com/tj/consolidate.js#supported-template-engines
// 2、下载模板引擎JS库
// 3、引入到页面中 --&gt;
&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/art-template/4.13.2/lib/template-web.min.js&quot;&gt;&lt;/script&gt;
&lt;!-- 
  script标签的特点：
  1、innerHTML永远不会显示在界面上(display: none;)
  2、如果type属性不是text/javascript，内部的内容不会作为JavaScript执行
 --&gt;
&lt;!-- // 4、准备一个模板 --&gt;
&lt;!-- 
  JavaScript中用变量保存(维护不方便、不能换行)
  ——&gt; HTML中放到一个div中通过样式隐藏(添加误用元素、多余样式)
  ——&gt; script标签type修改之后不会显示在页面中，建议text/x-开头
--&gt;
&lt;script id=&quot;tmpl&quot; type=&quot;text/x-art-template&quot;&gt;
{{each comments}}  
&lt;tr&gt;
  &lt;td&gt;{{$index+1}}&lt;/td&gt;
  &lt;td&gt;{{$value.author}}&lt;/td&gt;
  &lt;td&gt;{{$value.content}}&lt;/td&gt;
  &lt;td&gt;{{$value.created}}&lt;/td&gt;
&lt;/tr&gt;
{{/each}}
&lt;/script&gt;
&lt;script&gt;
var xhr = new XMLHttpRequest()
xhr.open(&#39;GET&#39;, &#39;test.php&#39;)
xhr.send()
xhr.onreadystatechange = function (){
  if(this.readyState !== 4) return
  var res = JSON.parse(this.responseText)
  // // 5、准备一个数据
  var context = {comments: res.data}  // 上面的关键词就是comments
  console.log(context)
  var html = template(&#39;tmpl&#39;, context)
  console.log(html)
  document.getElementById(&#39;comment&#39;).innerHTML = html

  // 6、通过模板引擎的JS提供一个函数将模板和数据整合得到渲染结果HTML
  // 7、将渲染结果的HTML设置到某个元素的innerHTML中
}
&lt;/script&gt;</code></pre>
<h3><span id="7-兼容方案">7、兼容方案</span></h3><p>XMLHttpRequest在老板浏览器(IE5/6)中有兼容问题，可以通过另一种方式代替</p>
<pre><code class="javascript">var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(&#39;Microsoft.XMLHTTP&#39;)</code></pre>
<h3><span id="8-补充">8、补充</span></h3><p>(1) response、responseText</p>
<p>都是获取的响应</p>
<p>response: 获取到的结果或根据this.responseType的变化而变化(可以表述二进制数据)</p>
<p>responseText: 永远获取的是字符串形式的响应体</p>
<pre><code class="javascript">var xhr = new XMLHttpRequest
xhr.open(&#39;GET&#39;, &#39;test.php&#39;)
xhr.send()
xhr.responseType = &#39;json&#39;  // 通过代码告诉请求代理对象，服务端响应给我们的是JSON
xhr.onreadystatechange = function (){
  if(this.readyState !== 4) return
  console.log(this)
  console.log(this.response)
  console.log(this.responseText)  // 由于设置了json，因此不存在
}</code></pre>
<p>(2) IE缓存问题：IE浏览器会将ajax返回结果缓存起来，再次发送请求时，显示的是本地缓存，而不是最新的请求到的数据</p>
<p>在服务端添加一个：</p>
<pre><code class="javascript">//针对 IE 缓存
app.get(&#39;/ie&#39;, (request, response) =&gt; {
  //设置响应头  设置允许跨域
  response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  //设置响应体
  response.send(&#39;HELLO AJAX IE&#39;);
});</code></pre>
<p>解决</p>
<pre><code class="html">&lt;style&gt;
  #result{
    width:200px;
    height:100px;
    border:solid 1px #258;
  }
&lt;/style&gt;
&lt;button&gt;点击发送请求&lt;/button&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  const btn = document.getElementsByTagName(&#39;button&#39;)[0];
  const result = document.querySelector(&#39;#result&#39;);

  btn.addEventListener(&#39;click&#39;, function(){
    const xhr = new XMLHttpRequest();
    xhr.open(&quot;GET&quot;,&#39;http://127.0.0.1:8000/ie?t=&#39;+Date.now()); // 解决方案：加上参数，这样浏览器认为每次请求url都不一样
    xhr.send();
    xhr.onreadystatechange = function(){
      if(xhr.readyState === 4){
        if(xhr.status &gt;= 200 &amp;&amp; xhr.status&lt; 300){
          result.innerHTML = xhr.response;
        }
      }
    }
  })
&lt;/script&gt;</code></pre>
<p>(3) 请求超时和网络异常</p>
<p><code>server.js</code>中添加</p>
<pre><code class="javascript">//延时响应
app.all(&#39;/delay&#39;, (request, response) =&gt; {
  //设置响应头  设置允许跨域
  response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
  // 手动设置一个延时效果
  setTimeout(() =&gt; {
    //设置响应体
    response.send(&#39;延时响应&#39;);
  }, 1000) // 3000
});</code></pre>
<p>进行处理，在2s内还没有响应则取消</p>
<pre><code class="html">&lt;style&gt;
  #result{
    width:200px;
    height:100px;
    border:solid 1px #90b;
  }
&lt;/style&gt;
&lt;button&gt;点击发送请求&lt;/button&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  const btn = document.getElementsByTagName(&#39;button&#39;)[0];
  const result = document.querySelector(&#39;#result&#39;);
  btn.addEventListener(&#39;click&#39;, function(){
    const xhr = new XMLHttpRequest();
    //超时设置 2s 设置
    xhr.timeout = 2000;
    //超时回调
    xhr.ontimeout = function(){
      alert(&quot;网络异常, 请稍后重试!!&quot;);
    }
    //网络异常回调
    xhr.onerror = function(){
      alert(&quot;你的网络似乎出了一些问题!&quot;);
    }
    xhr.open(&quot;GET&quot;,&#39;http://127.0.0.1:8000/delay&#39;);
    xhr.send();
    xhr.onreadystatechange = function(){
      if(xhr.readyState === 4){
        if(xhr.status &gt;= 200 &amp;&amp; xhr.status&lt; 300){
          result.innerHTML = xhr.response;
        }
      }
    }
  })
&lt;/script&gt;</code></pre>
<p>网络异常可以利用浏览器调试中Network一栏，设置为Offline</p>
<p>(3) 取消请求</p>
<p>利用abort()方法取消请求</p>
<pre><code class="html">&lt;button&gt;点击发送&lt;/button&gt;
&lt;button&gt;点击取消&lt;/button&gt;
&lt;script&gt;
  //获取元素对象
  const btns = document.querySelectorAll(&#39;button&#39;);
  let x = null; // 由于第二个按钮也需要用到
  btns[0].onclick = function(){
    x = new XMLHttpRequest();
    x.open(&quot;GET&quot;,&#39;http://127.0.0.1:8000/delay&#39;);
    x.send();
  }
  // abort
  btns[1].onclick = function(){
    x.abort();
  }
&lt;/script&gt;</code></pre>
<p>(3) ajax重复发送请求问题：用户频繁发送请求，对服务器压力很大</p>
<p>请求时，可以判断，如果前面有一条这样的请求，那么将前面的请求取消掉</p>
<pre><code class="html">&lt;button&gt;点击发送&lt;/button&gt;
&lt;script&gt;
  //获取元素对象
  const btns = document.querySelectorAll(&#39;button&#39;);
  let x = null;
  //标识变量
  let isSending = false; // 是否正在发送AJAX请求
  btns[0].onclick = function(){
    //判断标识变量
    if(isSending) x.abort();// 如果正在发送, 则取消该请求, 创建一个新的请求
    x = new XMLHttpRequest();
    //修改 标识变量的值
    isSending = true;
    x.open(&quot;GET&quot;,&#39;http://127.0.0.1:8000/delay&#39;);
    x.send();
    x.onreadystatechange = function(){
      if(x.readyState === 4){
        //修改标识变量
        isSending = false;
      }
    }
  }
&lt;/script&gt;</code></pre>
<h2><span id="四-封装">四、封装</span></h2><h3><span id="1-ajax请求封装">1、AJAX请求封装</span></h3><p>封装的套路：</p>
<p>(1)  写一个相对比较完善的用例</p>
<pre><code class="javascript">var xhr = new XMLHttpRequest
xhr.open(&#39;GET&#39;, &#39;test.php&#39;, true)
xhr.send(null)
xhr.addEventListener(&#39;readystatechange&#39;, function(){
  if(this.readyState !== 4) return
  console.log(this.responseText)
})</code></pre>
<p>(2)  写一个空函数，没有形参，将刚刚的用例直接作为函数的函数体</p>
<pre><code class="javascript">function ajax(){
  var xhr = new XMLHttpRequest
  xhr.open(&#39;GET&#39;, &#39;test.php&#39;, true)
  xhr.send(null)
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    console.log(this.responseText)
  })
}</code></pre>
<p>(3)  根据使用过程中的需求抽象参数</p>
<pre><code class="javascript">/*
Ajax请求 version1
method: 请求方式 GET/POST
url: 请求地址 &#39;http://xxx.com/api&#39;
*/
function ajax(method, url){
  var xhr = new XMLHttpRequest
  xhr.open(method, url, true)
  xhr.send(data)
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    console.log(this.responseText)
  })
}
ajax(&#39;GET&#39;, &#39;test.php&#39;)</code></pre>
<p>send需要传参</p>
<pre><code class="javascript">/*
Ajax请求 version2
method: 请求方式 GET/POST
url: 请求地址 &#39;http://xxx.com/api&#39;
params: 键值对字符串
*/
function ajax(method, url, params){
  var xhr = new XMLHttpRequest
  var data = null
  if(method === &#39;GET&#39;){
    url += &#39;?&#39; + params
  }
  xhr.open(method, url, true)
  if(method === &#39;POST&#39;){
    xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;)
    data = params || null
  }
  xhr.send(data)
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    console.log(this.responseText)
  })
}
ajax(&#39;GET&#39;, &#39;test.php&#39;)
ajax(&#39;POST&#39;, &#39;post.php&#39;, &#39;key1=value1&amp;key2=value2&#39;)</code></pre>
<p>send实参可以传对象</p>
<pre><code class="javascript">/*
Ajax请求 version3
method: 请求方式 GET/POST
url: 请求地址 &#39;http://xxx.com/api&#39;
params: 对象
*/
function ajax(method, url, params){
  var xhr = new XMLHttpRequest
  // 将Object类型的参数转换为 key1=value1&amp;key2=value2的形式
  if(typeof params === &#39;object&#39;){
    var tempArr = []
    for (var key in params){
      var value = params[key]
      tempArr.push(key + &#39;=&#39; + params[key])
      // tempArr =&gt; [&#39;key1=value1&#39;, &#39;key2=value2&#39;]
    }
    params = tempArr.join(&#39;&amp;&#39;)
    // tempArr =&gt; [&#39;key1=value1&amp;key2=value2&#39;]
  }
  if(method === &#39;GET&#39;){
    params ? url += &#39;?&#39; + params : url
  }
  xhr.open(method, url, true)
  var data = null
  if(method === &#39;POST&#39;){
    xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;)
    data = params || null
  }
  xhr.send(data)
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    console.log(this.responseText)
  })
}
ajax(&#39;GET&#39;, &#39;test.php&#39;)
ajax(&#39;GET&#39;, &#39;time.php&#39;, {id: 1})
ajax(&#39;POST&#39;, &#39;post.php&#39;, {key1: &#39;value1&#39;, key2: &#39;value2&#39;, key3: &#39;value3&#39;})
ajax(&#39;POST&#39;, &#39;post.php&#39;, &#39;key1=value1&amp;key2=value2&#39;)</code></pre>
<p>不应该在封装的函数中主观地处理响应结果</p>
<pre><code class="javascript">/*
Ajax请求 version4
method: 请求方式 GET/POST/get/post
url: 请求地址 &#39;http://xxx.com/api&#39;
params: 对象
*/
function ajax(method, url, params){
  var res = null
  method= method.toUpperCase()
  var xhr = new XMLHttpRequest
  // 将Object类型的参数转换为 key1=value1&amp;key2=value2的形式
  if(typeof params === &#39;object&#39;){
    var tempArr = []
    for (var key in params){
      var value = params[key]
      tempArr.push(key + &#39;=&#39; + params[key])
      // tempArr =&gt; [&#39;key1=value1&#39;, &#39;key2=value2&#39;]
    }
    params = tempArr.join(&#39;&amp;&#39;)
    // tempArr =&gt; [&#39;key1=value1&amp;key2=value2&#39;]
  }
  if(method === &#39;GET&#39;){
    params ? url += &#39;?&#39; + params : url
  }
  xhr.open(method, url, false) // 改为同步了
  var data = null
  if(method === &#39;POST&#39;){
    xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;)
    data = params || null
  }
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    // console.log(this.responseText)
    // return xhr.responseText // 无法再给外部函数返回结果，利用闭包、原型链
    res = this.responseText
  })
  xhr.send(data)
  // 由于是异步，会先执行(用同步，事件放到send前x不推荐)
  return res
}
console.log(ajax(&#39;post&#39;, &#39;post.php&#39;, {key1: &#39;value1&#39;, key2: &#39;value2&#39;, key3: &#39;value3&#39;}))</code></pre>
<p>不能使用同步模式</p>
<p>补充一个概念：</p>
<p>委托(或回调)</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185828.png" alt="image-20200815185827212"></p>
<p>函数可以理解为一个想要做的事情，函数体中约定了这件事情做的过程，直到调用时才开始工作。</p>
<p>将函数作为参数传递就像是将一件事情交给别人，这就是委托。</p>
<p>异步编程中回调/委托使用频率很高。（由于是异步的，你先执行，我告诉你做什么，我就不等了——等不及，你执行就行了）</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185846.png" alt="image-20200815185845589"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185858.png" alt="image-20200815185856765"></p>
<p>回调地狱/黑洞：死循环</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815185914.png" alt="image-20200815185913313"></p>
<p><font color="red"><strong>最终版本</strong></font></p>
<pre><code class="javascript">/*
发送一个Ajax请求 version5
@param (String) method  请求方式 GET/POST/get/post
@param (String) url     请求地址 &#39;http://xxx.com/api&#39;
@param (Object) params  请求参数
@param (Function) done  请求完成过后需要做的事情(委托/回调)
*/
function ajax(method, url, params, done){
  var res = null
  method= method.toUpperCase()
  var xhr = new XMLHttpRequest
  // 将Object类型的参数转换为 key1=value1&amp;key2=value2的形式
  if(typeof params === &#39;object&#39;){
    var tempArr = []
    for (var key in params){
      var value = params[key]
      tempArr.push(key + &#39;=&#39; + params[key])
    }
    params = tempArr.join(&#39;&amp;&#39;)
  }
  if(method === &#39;GET&#39;){
    params ? url += &#39;?&#39; + params : url
  }
  xhr.open(method, url, true)
  var data = null
  if(method === &#39;POST&#39;){
    xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;)
    data = params || null
  }
  xhr.send(data)
  xhr.addEventListener(&#39;readystatechange&#39;, function(){
    if(this.readyState !== 4) return
    res = this.responseText
    done(res)
  })
}

var ondone = function (res){
  console.log(&#39;准备执行&#39;)
  // console.log(res)
  alert(res)
  console.log(&#39;执行完成了&#39;)
}
ajax(&#39;post&#39;, &#39;post.php&#39;, {key1: &#39;value1&#39;, key2: &#39;value2&#39;}, ondone)
ajax(&#39;get&#39;, &#39;time.php&#39;, {}, function(res){
  console.log(res)
})</code></pre>
<h3><span id="2-jquery中的ajax">2、jQuery中的Ajax</span></h3><p>jQuery中有一套专门针对AJAX的封装，功能十分完善，经常使用，需要注意。</p>
<p><a href="https://www.jquery123.com/category/ajax/" target="_blank" rel="noopener">https://www.jquery123.com/category/ajax/</a></p>
<p>(1)通用方法$.ajax</p>
<p>底层接口(其他接口依赖于这个)</p>
<pre><code class="html">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// 1、最基础的调用
$.ajax(&#39;./time.php&#39;, { // url: 
  type: &#39;POST&#39;,  // method: 请求方法
  success: function(res){
    // res =&gt; 拿到的只是响应体
    console.log(res)
  }
})
// 可以把url写到里面去
$.ajax({ 
  url: &#39;./time.php&#39;,// url: 
  type: &#39;POST&#39;,  // method: 请求方法
  data: {id: 1, name: &#39;张三&#39;}, // 用于提交到服务端的参数
  /*
    get方式通过url传递
    post方式按照请求体传递
  */
  success: function(res){
    // res =&gt; 拿到的只是响应体
    console.log(res)
  }
})
// res返回格式
$.ajax({ 
  url: &#39;./json.php&#39;,// url: 请求地址
  type: &#39;get&#39;,  // method: 请求方法
  success: function(res){
    // res会根据服务器响应的Content-Type自动转换为对象
    // 这是jQuery内部实现的
    console.log(res)
  }
})
// 指定响应体类型
$.ajax({ 
  url: &#39;./json.php&#39;,// url: 
  type: &#39;get&#39;,  // method: 请求方法
  // data: {id: 1, name: &#39;张三&#39;}, // 设置请求参数
  dataType: &#39;json&#39;, // 用于设置响应体的类型(与data参数没关系)
  success: function(res){
    // 一旦设置了dataType选项，就不再关心服务端响应的Content-Type了
    // 客户端会主观地认为服务端返回的就是json格式
    console.log(res)
  }
})
&lt;/script&gt;</code></pre>
<p>原生操作中不论请求状态码是多少都会触发回调</p>
<p>jQuery中ajax的回调</p>
<pre><code class="html">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// jQuery中ajax的回调
$.ajax({ 
  url: &#39;./time.php&#39;, // url
  data: {key1:value1, key2:value2}, // 参数
  type: &#39;POST&#39;,  // method: 请求方法
  dataType: &#39;json&#39;, // 响应体结果
  beforeSend: function(xhr){
    // 在所有发送请求得操作(open、send)之前执行
    console.log(&#39;beforeSend&#39;, xhr)
  }
  success: function(res){ // 成功的回调
    // 只有请求成功(状态码为200)才会执行这个函数
    // res =&gt; 拿到的只是响应体
    console.log(res)
  },
  // timeout: 2000, // 超时时间
  error: function(xhr){ // 失败的回调
    // 只有请求不正常才会执行(状态码不为200)
    console.log(&#39;error&#39;,xhr)
  },
  complete: function(xhr){
    // 不管成功还是失败都是完成，都会执行这个complete函数
    console.log(&#39;complete&#39;, xhr)
  }
})
&lt;/script&gt;</code></pre>
<p>(2) 高级封装</p>
<pre><code class="html">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// 2、jQuery中ajax的快捷方法
$.get(&#39;time.php&#39;, function(res){
  console.log(res)
})
$.post(&#39;time.php&#39;, function(res){
  console.log(res)
})
// 服务端设置了json能转换对象，没设置不行
$.get(&#39;time.php&#39;, {id: 1}, function(res){
  console.log(res)
})
$.post(&#39;time.php&#39;, {id: 1}, function(res){
  console.log(res)
})
// 无视服务端Content-Type，视作JSON格式
$.getJSON(&#39;json.php&#39;, {id: 1}, function(res){
  console.log(res)
})
$.postJSON(&#39;json.php&#39;, {id: 1}, function(res){
  console.log(res)
})
明确请求的方式，根据方式选择快捷方法
&lt;/script&gt;</code></pre>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190207.png" alt="image-20200815190206531"></p>
<pre><code class="html">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// 跳转其他页面，会白屏，但是有些页面只是部分不相同，可以局部刷新
$(function($){
  // 有一个独立的作用域，顺便确保页面加载完成执行
  $(&#39;a.item&#39;).on(&#39;click&#39;, function(){
    var url = $(this).attr(&#39;href&#39;)
    $(&#39;#main&#39;).load(url + &#39; #main&gt;*&#39;) // 元素.load(链接+空格+选择器)
    // 阻止a的默认行为
    return false
  })
})
&lt;/script&gt;</code></pre>
<p>将jQuery的几种方式汇总一下：</p>
<p><code>server.js</code>中：</p>
<pre><code class="javascript">//jQuery 服务
app.all(&#39;/jquery-server&#39;, (request, response) =&gt; {
    //设置响应头  设置允许跨域
    response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
    response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
    // response.send(&#39;Hello jQuery AJAX&#39;);
    const data = {name:&#39;wallleap&#39;};
    response.send(JSON.stringify(data));
});</code></pre>
<p>前端</p>
<pre><code class="html">&lt;link crossorigin=&quot;anonymous&quot; href=&quot;https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;script crossorigin=&quot;anonymous&quot; src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;!-- crossorigin=&quot;anonymous&quot;：跨域源请求设置，加上之后向这个资源发送请求时不会携带当前域名下的cookie --&gt;
&lt;div class=&quot;container&quot;&gt;
    &lt;h2 class=&quot;page-header&quot;&gt;jQuery发送AJAX请求 &lt;/h2&gt;
    &lt;button class=&quot;btn btn-primary&quot;&gt;GET&lt;/button&gt;
    &lt;button class=&quot;btn btn-danger&quot;&gt;POST&lt;/button&gt;
    &lt;button class=&quot;btn btn-info&quot;&gt;通用型方法ajax&lt;/button&gt;
&lt;/div&gt;
&lt;script&gt;
  $(&#39;button&#39;).eq(0).click(function(){
    $.get(&#39;http://127.0.0.1:8000/jquery-server&#39;, {a:100, b:200}, function(data){
      console.log(data);
    },&#39;json&#39;);
  });
  $(&#39;button&#39;).eq(1).click(function(){
    $.post(&#39;http://127.0.0.1:8000/jquery-server&#39;, {a:100, b:200}, function(data){
      console.log(data);
    });
  });
  $(&#39;button&#39;).eq(2).click(function(){
    $.ajax({
      //url
      url: &#39;http://127.0.0.1:8000/jquery-server&#39;,
      //参数
      data: {a:100, b:200},
      //请求类型
      type: &#39;GET&#39;,
      //响应体结果
      dataType: &#39;json&#39;,
      //成功的回调
      success: function(data){
        console.log(data);
      },
      //超时时间
      timeout: 2000,
      //失败的回调
      error: function(){
        console.log(&#39;出错啦!!&#39;);
      },
      //头信息
      headers: {
        c:300,
        d:400
      }
    });
  });
&lt;/script&gt;</code></pre>
<p>(3) 全局事件及配置NProgress显示加载进度</p>
<pre><code class="html">&lt;style&gt;
  .loading{
    display: none;
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background-color: rgba(85, 85, 85, .5);
    text-align: center;
    padding-top: 200px;
    color: #fff;
    font-size: 50px;
  }
&lt;/style&gt;
&lt;div class=&quot;loading&quot;&gt;正在玩命加载中……&lt;/div&gt;
&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// 3、jQuery全局事件处理函数
/*
$.ajax({
  url: &#39;time.php&#39;,
  beforeSend: function(xhr){
    // 显示加载提示
    $(&#39;.loading&#39;).fadeIn()
    console.log(&#39;即将开始请求&#39;)
  },
  complete: function(xhr){
    // 结束提示
    $(&#39;.loading&#39;).fadeOut()
    console.log(&#39;请求结束了&#39;)
  }
})
*/
// 所有的ajax请求开始和结束
$(document).ajaxStart(function(){
  // 只要有ajax请求发生就会执行
  // 显示加载提示
  $(&#39;.loading&#39;).fadeIn()
  console.log(&#39;即将开始请求&#39;)
})
$(document).ajaxStop(function(){
  // 只要有ajax请求发生就会执行
  // 显示加载提示
  $(&#39;.loading&#39;).fadeOut()
  console.log(&#39;请求结束了&#39;)
})
$(&#39;body&#39;).on(&#39;click&#39;, function(){
  // $.ajax({
  //   url: &#39;time.php&#39;
  // })
  $.get(&#39;time.php&#39;)
})
&lt;/script&gt;</code></pre>
<p>可以写成链式的：</p>
<pre><code class="javascript">$(document)
  .ajaxStart(function(){
    ……
  })
  .ajaxStop(function(){
    ……
  })</code></pre>
<p>搭配NProgress</p>
<pre><code class="html">&lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.css&quot;&gt;
&lt;script src=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div style=&quot;margin-top: 100px;text-align: center;&quot;&gt;点击加载&lt;/div&gt;
&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// 3、jQuery全局事件处理函数搭配nprogress
// 所有的ajax请求开始和结束
$(document)
  .ajaxStart(function(){
    // 只要有ajax请求发生就会执行
    NProgress.start()
  })
  .ajaxStop(function(){
    // 只要有ajax请求发生就会执行
    NProgress.done()
  })
$(&#39;body&#39;).on(&#39;click&#39;, function(){
  $.get(&#39;time.php&#39;)
})
&lt;/script&gt;
&lt;/body&gt;</code></pre>
<h3><span id="3-axios">3、axios</span></h3><p>(1) 使用教程：<a href="http://www.axios-js.com/zh-cn/docs/" target="_blank" rel="noopener">http://www.axios-js.com/zh-cn/docs/</a></p>
<p>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。</p>
<p>(2) 特性</p>
<ul>
<li>从浏览器中创建 <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener">XMLHttpRequests</a></li>
<li>从 node.js 创建 <a href="http://nodejs.org/api/http.html" target="_blank" rel="noopener">http</a> 请求</li>
<li>支持 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">Promise</a> API</li>
<li>拦截请求和响应</li>
<li>转换请求数据和响应数据</li>
<li>取消请求</li>
<li>自动转换 JSON 数据</li>
<li>客户端支持防御 <a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank" rel="noopener">XSRF</a></li>
</ul>
<p>(3) 安装</p>
<p>使用 npm:</p>
<pre><code class="sh">$ npm install axios</code></pre>
<p>使用 bower:</p>
<pre><code class="bash">$ bower install axios</code></pre>
<p>使用 cdn:</p>
<pre><code class="html">&lt;script src=&quot;https://unpkg.com/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>(4) 案例</p>
<p><code>server.js</code></p>
<pre><code class="javascript">//axios 服务
app.all(&#39;/axios-server&#39;, (request, response) =&gt; {
    //设置响应头  设置允许跨域
    response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
    response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
    // response.send(&#39;Hello jQuery AJAX&#39;);
    const data = {name:&#39;wallleap&#39;};
    response.send(JSON.stringify(data));
});</code></pre>
<p>axios发送Ajax请求</p>
<pre><code class="html">&lt;script crossorigin=&quot;anonymous&quot; src=&quot;https://cdn.bootcdn.net/ajax/libs/axios/0.19.2/axios.js&quot;&gt;&lt;/script&gt;
&lt;button&gt;GET&lt;/button&gt;
&lt;button&gt;POST&lt;/button&gt;
&lt;button&gt;AJAX&lt;/button&gt;
&lt;script&gt;
  // https://github.com/axios/axios
  const btns = document.querySelectorAll(&#39;button&#39;);
  //配置 baseURL
  axios.defaults.baseURL = &#39;http://127.0.0.1:8000&#39;;
  btns[0].onclick = function () {
    //GET 请求 get(url, 其它配置)
    // axios.get(&#39;http://127.0.0.1:8000/axios-server&#39;, {
    axios.get(&#39;/axios-server&#39;, { // 配置了baseURL
      //url 参数——&gt;id=100&amp;vip=7
      params: {
        id: 100,
        vip: 7
      },
      //请求头信息
      headers: {
        name: &#39;wallleap&#39;,
        age: 20
      }
    }).then(value =&gt; { // 基于promise 处理返回结果 value.config、data、headers、request、status、statusText
      console.log(value);
    });
  }
  btns[1].onclick = function () {
    // POST请求 post(url, 请求体, 其它配置)
    axios.post(&#39;/axios-server&#39;, { // 请求体
      username: &#39;admin&#39;,
      password: &#39;password&#39;
    }, {
      //url 
      params: {
        id: 200,
        vip: 9
      },
      //请求头参数
      headers: {
        height: 180,
        weight: 180,
      }
    }).then(response=&gt;{
      // 配置
      console.log(response.config);
      // XMLHttpRequest
      console.log(response.request);
      //响应状态码
      console.log(response.status);
      //响应状态字符串
      console.log(response.statusText);
      //响应头信息
      console.log(response.headers);
      //响应体
      console.log(response.data);
    })
  }
  btns[2].onclick = function(){
    // 通用方式 axios(对象) --&gt; {method, url, 参数, 头信息, 请求体参数}
    axios({
      //请求方法
      method : &#39;POST&#39;,
      //url
      url: &#39;/axios-server&#39;,
      //url参数
      params: {
        vip:10,
        level:30
      },
      //头信息
      headers: {
        a:100,
        b:200
      },
      //请求体参数
      data: {
        username: &#39;admin&#39;,
        password: &#39;password&#39;
      }
    }).then(response=&gt;{
      //响应状态码
      console.log(response.status);
      //响应状态字符串
      console.log(response.statusText);
      //响应头信息
      console.log(response.headers);
      //响应体
      console.log(response.data);
    }).catch(function (error) {
      console.log(error);
    })
  }
&lt;/script&gt;</code></pre>
<h2><span id="4-fetch">4、fetch</span></h2><p>fetch使用：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch</a></p>
<p>fetch发送AJAX请求</p>
<p><code>server.js</code></p>
<pre><code class="javascript">//fetch 服务
app.all(&#39;/fetch-server&#39;, (request, response) =&gt; {
    //设置响应头  设置允许跨域
    response.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
    response.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;);
    // response.send(&#39;Hello jQuery AJAX&#39;);
    const data = {name:&#39;wallleap&#39;};
    response.send(JSON.stringify(data));
});</code></pre>
<pre><code class="html">&lt;button&gt;AJAX请求&lt;/button&gt;
&lt;script&gt;
  //文档地址
  //https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/fetch
  const btn = document.querySelector(&#39;button&#39;);
  btn.onclick = function(){
    fetch(&#39;http://127.0.0.1:8000/fetch-server?vip=10&#39;, {
      //请求方法
      method: &#39;POST&#39;,
      //请求头
      headers: {
        name:&#39;atguigu&#39;
      },
      //请求体
      body: &#39;username=admin&amp;password=admin&#39;
    }).then(response =&gt; {
      // return response.text();
      return response.json();
    }).then(response=&gt;{
      console.log(response);
    });
  }
&lt;/script&gt;</code></pre>
<h2><span id="五-跨域">五、跨域</span></h2><h3><span id="1-概念">1、概念</span></h3><p>(1) 同源策略(Same-Origin Policy)：最早由Netscape公司提出，是浏览器的一种安全策略，所谓同源是指<strong>协议、域名、端口</strong>完全相同，只有同源的地址才可以相互通过AJAX的方式请求。</p>
<p>下面来一个同源的案例：</p>
<p>重写一个<code>server.js</code></p>
<pre><code class="javascript">const express = require(&#39;express&#39;);
const app = express();
app.get(&#39;/home&#39;, (request, response)=&gt;{
    //响应一个页面
    response.sendFile(__dirname + &#39;/index.html&#39;);
});
app.get(&#39;/data&#39;, (request, response)=&gt;{
    response.send(&#39;用户数据&#39;);
});
app.listen(9000, ()=&gt;{
    console.log(&quot;服务已经启动...&quot;);
});</code></pre>
<p>运行起来</p>
<pre><code class="sh">nodemon server.js</code></pre>
<p>在这个目录下新建<code>index.html</code></p>
<pre><code class="html">&lt;h1&gt;wallleap&lt;/h1&gt;
&lt;button&gt;点击获取用户数据&lt;/button&gt;
&lt;script&gt;
  const btn = document.querySelector(&#39;button&#39;);
  btn.onclick = function(){
    const x = new XMLHttpRequest();
    //这里因为是满足同源策略的, 所以 url 可以简写
    x.open(&quot;GET&quot;,&#39;/data&#39;);
    //发送
    x.send();
    //
    x.onreadystatechange = function(){
      if(x.readyState === 4){
        if(x.status &gt;= 200 &amp;&amp; x.status &lt; 300){
          console.log(x.response);
        }
      }
    }
  }
&lt;/script&gt;</code></pre>
<p>访问<a href="http://127.0.0.1:9000/home，可以访问这个index.html，点击按钮可以获取到数据" target="_blank" rel="noopener">http://127.0.0.1:9000/home，可以访问这个index.html，点击按钮可以获取到数据</a></p>
<p>(2) 同源或者不同源说的是两个地址之间的关系，不同源地址之间请求我们称之为跨域请求。</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190430.png" alt="image-20200815190429165"></p>
<p>跨域的案例：</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190440.png" alt="image-20200815190439633"></p>
<p>跨域会报错：</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190456.png" alt="image-20200815190455302"></p>
<h3><span id="2-解决方案">2、解决方案</span></h3><p>不同源地址之间如果需要相互请求，必须服务端和客户端配合才能完成</p>
<p>尝试找到一种可以发送不同源请求的方式</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190529.png" alt="可能可以解决跨域的方法"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190556.png" alt="正常图片标签"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190621.png" alt="尝试使用img标签解决跨域"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190650.png" alt="正常link标签"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190712.png" alt="尝试使用link标签解决跨域"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190738.png" alt="尝试使用script标签解决跨域"></p>
<p>初级跨域解决方案</p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190812.png" alt="服务器端将json用函数包裹返回"></p>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815190858.png" alt="客户端使用该函数拿到数据"></p>
<p>(1) <strong>JSONP</strong></p>
<p>JSON with Padding，是一种借助于<code>script</code>标签发送跨域请求的技巧。这个是非官方的跨域解决方案，是程序员们机智地想出来的，只支持get请求。</p>
<p>其原理就是在客户端借助<code>script</code>标签请求服务端的一个动态网页(php等)，服务端的这个动态网页返回一段带有函数调用的JavaScript全局函数调用的脚本，将原本需要返回给客户端的数据传递进去。</p>
<p>以后绝大多数情况都是采用JSONP的手段完成不同源地址之间的跨域请求。</p>
<ul>
<li>原理演示：</li>
</ul>
<p>当前目录下，新建<code>js/app.js</code></p>
<pre><code class="javascript">const data = {
    name: &#39;测试jsonp&#39;
};
/* 把这个挪走，到测试的html文件中
//处理数据
    function handle(data) {
        //获取 result 元素
        const result = document.getElementById(&#39;result&#39;);
        result.innerHTML = data.name;
    }
*/
handle(data);</code></pre>
<p>html</p>
<pre><code class="html">&lt;style&gt;
  #result {
    width: 300px;
    height: 100px;
    border: solid 1px #78a;
  }
&lt;/style&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    //处理数据
    function handle(data) {
        //获取 result 元素
        const result = document.getElementById(&#39;result&#39;);
        result.innerHTML = data.name;
    }
&lt;/script&gt;
&lt;!-- &lt;script src=&quot;http://127.0.0.1:5500/jsonp/js/app.js&quot;&gt;&lt;/script&gt; --&gt; &lt;!-- 利用file://方式访问这个html页面 --&gt;
&lt;!-- 进阶版 --&gt;
&lt;script src=&quot;http://127.0.0.1:8000/jsonp-server&quot;&gt;&lt;/script&gt;</code></pre>
<p><code>server.js</code></p>
<pre><code class="javascript">//jsonp服务
app.all(&#39;/jsonp-server&#39;,(request, response) =&gt; {
    // response.send(&#39;console.log(&quot;hello jsonp&quot;)&#39;); // 前端拿到js代码
    const data = {
        name: &#39;测试jsonp&#39;
    };
    //将数据转化为字符串
    let str = JSON.stringify(data);
    //返回结果
    response.end(`handle(${str})`); // 会返回一个函数调用，实参是想返回给前端的数据(前端需要先声明这个函数)
});</code></pre>
<ul>
<li>用php演示一下</li>
</ul>
<p><code>server.php</code></p>
<pre><code class="php">&lt;?php
$conn = mysqli_connect(&#39;localhost&#39;, &#39;root&#39;, &#39;123456&#39;, &#39;demo&#39;);
$query = mysqli_query($conn, &#39;select * from users&#39;);
while ($row = mysqli_fetch_assoc($query)) {
  $data[] = $row;
}
if (empty($_GET[&#39;callback&#39;])) {
  header(&#39;Content-Type: application/json&#39;);
  echo json_encode($data);
  exit();
}
// 如果客户端采用的是 script 标记对我发送的请求
// 一定要返回一段 JavaScript
header(&#39;Content-Type: application/javascript&#39;);
$result = json_encode($data);
$callback_name = $_GET[&#39;callback&#39;];
echo &quot;typeof {$callback_name} === &#39;function&#39; &amp;&amp; {$callback_name}({$result})&quot;;</code></pre>
<p><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/pic/illustration/20200815191014.png" alt="image-20200815191013064"></p>
<ul>
<li>原生方式实践jsonp</li>
</ul>
<p><code>server.js</code></p>
<pre><code class="javascript">//用户名检测是否存在
app.all(&#39;/check-username&#39;,(request, response) =&gt; {
    // response.send(&#39;console.log(&quot;hello jsonp&quot;)&#39;);
    const data = {
        exist: 1,
        msg: &#39;用户名已经存在&#39;
    };
    //将数据转化为字符串
    let str = JSON.stringify(data);
    //返回结果
    response.end(`handle(${str})`);
});</code></pre>
<p>前端代码：</p>
<pre><code class="html">用户名: &lt;input type=&quot;text&quot; id=&quot;username&quot;&gt;
&lt;p&gt;&lt;/p&gt;
&lt;script&gt;
  //获取 input 元素
  const input = document.querySelector(&#39;input&#39;);
  const p = document.querySelector(&#39;p&#39;);
  //声明 handle 函数
  function handle(data){
    input.style.border = &quot;solid 1px #f00&quot;;
    //修改 p 标签的提示文本
    p.innerHTML = data.msg;
  }
  //绑定事件
  input.onblur = function(){
    //获取用户的输入值
    let username = this.value;
    //向服务器端发送请求 检测用户名是否存在
    //1. 创建 script 标签
    const script = document.createElement(&#39;script&#39;);
    //2. 设置标签的 src 属性
    script.src = &#39;http://127.0.0.1:8000/check-username&#39;;
    //3. 将 script 插入到文档中
    document.body.appendChild(script);
  }
&lt;/script&gt;</code></pre>
<ul>
<li>封装成一个函数</li>
</ul>
<pre><code class="javascript">function jsonp (url, params, callback) {
  var funcName = &#39;jsonp_&#39; + Date.now() + Math.random().toString().substr(2, 5)

  if (typeof params === &#39;object&#39;) {
    var tempArr = []
    for (var key in params) {
      var value = params[key]
      tempArr.push(key + &#39;=&#39; + value)
    }
    params = tempArr.join(&#39;&amp;&#39;)
  }

  var script = document.createElement(&#39;script&#39;)
  script.src = url + &#39;?&#39; + params + &#39;&amp;callback=&#39; + funcName
  document.body.appendChild(script)

  window[funcName] = function (data) {
    callback(data)

    delete window[funcName]
    document.body.removeChild(script)
  }
}

jsonp(&#39;http://localhost/jsonp/server.php&#39;, { id: 123 }, function (res) {
  console.log(res)
})

jsonp(&#39;http://localhost/jsonp/server.php&#39;, { id: 123 }, function (res) {
  console.log(res)
})</code></pre>
<ul>
<li>jQuery方式实践jsonp</li>
</ul>
<p><code>server.js</code></p>
<pre><code class="javascript">// jQuery jsonp
app.all(&#39;/jquery-jsonp-server&#39;,(request, response) =&gt; {
  // response.send(&#39;console.log(&quot;hello jsonp&quot;)&#39;);
  const data = {
    name:&#39;尚硅谷&#39;,
    city: [&#39;北京&#39;,&#39;上海&#39;,&#39;深圳&#39;]
  };
  //将数据转化为字符串
  let str = JSON.stringify(data);
  //接收 callback 参数
  let cb = request.query.callback; // 函数名从前端获取
  //返回结果
  response.end(`${cb}(${str})`);
});</code></pre>
<p>前端代码：</p>
<pre><code class="html">&lt;style&gt;
  #result{
    width:300px;
    height:100px;
    border:solid 1px #089;
  }
&lt;/style&gt;
&lt;script crossorigin=&quot;anonymous&quot; src=&#39;https://cdn.bootcss.com/jquery/3.5.0/jquery.min.js&#39;&gt;&lt;/script&gt;
&lt;button&gt;点击发送 jsonp 请求&lt;/button&gt;
&lt;div id=&quot;result&quot;&gt;

&lt;/div&gt;
&lt;script&gt;
  $(&#39;button&#39;).eq(0).click(function(){
    $.getJSON(&#39;http://127.0.0.1:8000/jquery-jsonp-server?callback=?&#39;, function(data){
      $(&#39;#result&#39;).html(`
                名称: ${data.name}&lt;br&gt;
                校区: ${data.city}
            `)
    });
  });
&lt;/script&gt;</code></pre>
<p>(2)CORS</p>
<p>HTTP访问控制（CORS）<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a></p>
<p>Cross Origin Resource Share，跨域资源共享。CORS是官方的跨域解决方案，它的特点是不需要再客户端做任何特殊的操作，完全在服务器中进行处理，支持get和post请求(其他也支持)。跨域资源共享标准新增了一组HTTP首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源。</p>
<p>CORS是通过设置一个响应头来告诉浏览器，这个请求允许跨域，浏览器收到该响应以后就会对响应放行。</p>
<p><code>server.js</code></p>
<pre><code class="javascript">app.all(&#39;/cors-server&#39;, (request, response)=&gt;{
  //设置响应头
  response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;); // 允许所有源站发送请求
  response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &#39;*&#39;); // 允许携带的响应头
  response.setHeader(&quot;Access-Control-Allow-Method&quot;, &#39;*&#39;); // 允许请求方法
  // response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;http://127.0.0.1:5500&quot;); // 允许单个
  response.send(&#39;hello CORS&#39;);
});</code></pre>
<p>测试：</p>
<pre><code class="html">&lt;style&gt;
    #result{
        width:200px;
        height:100px;
        border:solid 1px #90b;
    }
&lt;/style&gt;
&lt;button&gt;发送请求&lt;/button&gt;
&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  const btn = document.querySelector(&#39;button&#39;);
  btn.onclick = function(){
    //1. 创建对象
    const x = new XMLHttpRequest();
    //2. 初始化设置
    x.open(&quot;GET&quot;, &quot;http://127.0.0.1:8000/cors-server&quot;);
    //3. 发送
    x.send();
    //4. 绑定事件
    x.onreadystatechange = function(){
      if(x.readyState === 4){
        if(x.status &gt;= 200 &amp;&amp; x.status &lt; 300){
          //输出响应体
          console.log(x.response);
        }
      }
    }
  }
&lt;/script&gt;</code></pre>
<pre><code class="php">// 允许远端访问(甚至直接打开文件的方式也可以file://……)
header(&#39;Access-Control-Allow-Origin: *&#39;) // 允许所有
header(&#39;Access-Control-Allow-Origin: http://localhost/index.html&#39;) // 允许单个</code></pre>
<p>eg:</p>
<pre><code class="php">&lt;?php

$conn = mysqli_connect(&#39;localhost&#39;, &#39;root&#39;, &#39;123456&#39;, &#39;demo&#39;);

$query = mysqli_query($conn, &#39;select * from users&#39;);

while ($row = mysqli_fetch_assoc($query)) {
  $data[] = $row;
}

// 一行代码搞定
// 允许跨域请求
header(&#39;Access-Control-Allow-Origin: *&#39;);

header(&#39;Content-Type: application/json&#39;);
echo json_encode($data);</code></pre>
<p>客户端</p>
<pre><code class="html">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  $.get(&#39;http://localhost/cors.php&#39;, {}, function (res) {
    console.log(res)
  })
&lt;/script&gt;</code></pre>
<p>这种方案无序客户端作出任何变化(不用改代码)，只是在被请求的服务端响应的时候<strong>添加一个<code>Access-Control-Allow-Origin</code>的响应头</strong>，表示这个资源是否允许指定域请求。</p>
<h2><span id="六-xmlhttprequest20">六、XMLHttpRequest2.0</span></h2><blockquote>
<p>暂作了解，无需着重看待</p>
</blockquote>
<p>更易用，更强大。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
      
      
       
    </div>
</article>




<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>

<!-- 
<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>Ajax学习笔记</p>
    <p><span class="copy-title">字数:</span><span class="post-count">11.8k</span></p>
    <p><span class="copy-title">本文作者:</span><a  title="Luwang">Luwang</a></p>
    <p><span class="copy-title">发布时间:</span>2020-08-20, 12:33:14</p>
    <p><span class="copy-title">最后更新:</span>2020-09-11, 21:49:36</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2020/08/20/AJAX/" title="Ajax学习笔记">https://wallleap.cn/2020/08/20/AJAX/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">&#34;署名-非商用-相同方式共享 4.0&#34;</a> 转载请保留原文链接及作者。
    </p>
</div>
 -->

    <div class="article_copyright">
        <p><span class="copy-title">文章标题:</span>Ajax学习笔记</p>
        <p><span class="copy-title">文章字数:</span><span class="post-count">11.8k</span></p>
        <p><span class="copy-title">本文作者:</span><a  title="Luwang">Luwang</a></p>
        <p><span class="copy-title">发布时间:</span>2020-08-20, 12:33:14</p>
        <p><span class="copy-title">最后更新:</span>2020-09-11, 21:49:36</p>
        <span class="copy-title">原始链接:</span><a class="post-url" href="/2020/08/20/AJAX/" title="Ajax学习笔记">https://wallleap.cn/2020/08/20/AJAX/</a>
        <p>
            <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>
    
    
    

    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'c34c4610e9454bf73702',
            clientSecret: 'bccb16d6af22e10394fcf4fc3bb916f541b0492c',
            repo: 'comment',
            owner: 'wallleap',
            admin: ['wallleap'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>







    </div>
    <div class="copyright">
        <!-- <p class="footer-entry"><span class="miit">
                <img src="/img/gov.png" title="中华人民共和国工业和信息化部">
                <a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">赣ICP备20000895号</a>
        </span>
    
    ©2019-2020 wallleap
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p> -->



<div id="colophon" class="site-footer" role="contentinfo" style="background-color: transparent;font-size: 12px;">
    <div class="site-info">
        <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        <a style="color: #b9b9b9;" href="https://www.jinrishici.com/" target="_blank" rel="noopener"><span id="poem_sentence" style="text-align: left;"></span>
        <span id="poem_info" style="text-align: right;"></span></a>
        <script type="text/javascript">
          jinrishici.load(function(result) {
            var sentence = document.querySelector("#poem_sentence")
            var info = document.querySelector("#poem_info")
            sentence.innerHTML = result.data.content
            info.innerHTML = '【' + result.data.origin.dynasty + '】' + result.data.origin.author + '《' + result.data.origin.title + '》'
          });
        </script>
      <!-- // 文字滚动 -->
      
      <!-- <div id="binft" style="text-align:center; color: #666666;"></div>
      <script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/textScroll.js"></script> -->
     
      <div class="footertext">
        <div class="img-preload">
          <img src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/other/wordpress-rotating-ball-o.svg">
          <img src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/other/disqus-preloader.svg">
        </div>
    
          
  
        <p style="color: #666666;"><a href="#" style="color: #b9b9b9;">Blog wallleap</a>
          , Copyright &copy; 2019-2020 
          by Luwang All Rights Reserved.</p>
      </div>
      <!-- <div class="footer-device">
      <p style="font-family: 'Ubuntu', sans-serif;">
          <i class="fa fa-fire" aria-hidden="true"></i>
          <span style="color: #666;">
            Theme <a style="color: #b9b9b9;" href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank" style="color: #b9b9b9; text-decoration: underline dotted rgba(0, 0, 0, .1);">3-hexo</a>
             <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> 
             by <a href="https://yelog.org/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">yelog</a>
             , Powered by <a style="color: #b9b9b9;" href="https://hexo.io/" target="_blank">Hexo</a>
             , Hosted by <a style="color: #b9b9b9;" href="https://coding.net/" target="_blank">Coding Pages</a>
              & <a style="color: #b9b9b9;" href="https://github.com/" target="_blank">Github Pages</a>
          </span>
        </p>
      </div> -->
  
      
      <a style="color: #b9b9b9;" href="http://beian.miit.gov.cn/" target="_blank">	
        <img src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/logo/ICP.png" style="vertical-align: text-bottom; width: 17px;" />
        赣ICP备20000895号-1
      </a>
      <a href="https://icp.gov.moe" target="_blank"><img style="width:17px;margin-bottom: -2px;" src="https://icp.gov.moe/images/ico64.png">萌ICP备 </a><a href="https://icp.gov.moe/?keyword=20200895" target="_blank"> 20200895号</a>
      
      <span style="color: #666;padding-left: 20px;">
        <i class="fa fa-clock-o" aria-hidden="true"></i>
        <span id="time" align="center">载入时间中...</span>
        <script>
          var now = new Date(); 
          function createtime() { 
            var grt= new Date("08/08/2019 17:38:00");//在此处修改你的建站时间
            now.setTime(now.getTime()+250); 
            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
            document.getElementById("time").innerHTML = "小站已经苟活 "+dnum+" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
         } 
         setInterval("createtime()",250);
        </script>
        <!-- <span style="color:#666;padding-left: 20px;"><i class="fa fa-eye" aria-hidden="true"></i>访问量: <span class="site_pv"></span>次</span> -->
        <span style="padding-left: 20px; color:#666;"><i class="fa fa-cog fa-spin" aria-hidden="true"></i></span>
        <script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278079074'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1278079074%26online%3D2' type='text/javascript'%3E%3C/script%3E"));</script>
        
      </span>
      <div style="text-align:center; padding-top: 20px;">
        <div class="github-badge">
          <a rel="license" href="https://hexo.io/" target="_blank" title="由Hexo强力驱动">
          <span class="badge-subject"><i class="fa fa-fire" aria-hidden="true"></i> Powered</span><span class="badge-value bg-blue">Hexo</span></a>
        </div>
        <div class="github-badge">
          <a rel="license" href="https://github.io/" target="_blank" title="静态网页托管于Github">
          <span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen"><i class="fa fa-github" aria-hidden="true"></i> Github</span></a>
        </div>
        <div class="github-badge">
            <a rel="license" href="https://coding.net/" target="_blank" title="静态网页托管于CODING">
            <span class="badge-subject"><i class="fa fa-heart" aria-hidden="true"></i> Hosted</span>
            <span class="badge-value bg-gray">CODING</span></a>
          </div>
        <div class="github-badge">
            <a rel="license" href="https://www.jsdelivr.com/" target="_blank" title="jsDelivr提供CDN加速服务">
            <span class="badge-subject"><i class="fa fa-firefox fa-spin" aria-hidden="true"></i> CND</span><span class="badge-value bg-cdn">Github&jsDelivr</span></a>
        </div>
        <div class="github-badge">
            <a rel="license" href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank" title="站点使用 Sakura 主题，作者：Mashiro & Hojun">
            <span class="badge-subject"><i class="fa fa-themeisle" aria-hidden="true"></i> Theme</span><span class="badge-value bg-theme">3-blog</span></a>
        </div>
        <div class="github-badge">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="本站点采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可">
            <span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-lightgrey">BY-NC-SA 4.0</span></a>
        </div>
        <div class="github-badge">
          <span class="badge-subject"><i class="fa fa-user" aria-hidden="true"></i> UV</span>
          <span  class="site_uv badge-value bg-orange""></span>
        </div>
        <div class="github-badge">
          <span class="badge-subject"><i class="fa fa-eye" aria-hidden="true"></i> PV</span>
          <span class="site_pv badge-value bg-brightgreen"></span>
        </div>
      </div>  
  
      <div class="site-img" style="margin-top:20px;">
        <a href="#"><img width="350px" src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/img/wechat/wallleap.png"></a>
        <!-- <a href="https://www.google.com/search?sxsrf=ACYBGNT2ZrasjGUBG6Nj1_Xye1N67lpsrA%3A1573382249794&source=hp&ei=aejHXey4LYHu-gSQlLqgDg&q=site%3Awallleap.cn&oq=site%3Awallleap.cn&gs_l=psy-ab.3...32142.36345..36698...0.0..4.1018.9243.3-5j2j5j3j1......0....1..gws-wiz.....10..35i362i39j35i39j0.9jvLRXQs6zM&ved=0ahUKEwiskd7Qud_lAhUBt54KHRCKDuQQ4dUDCAY&uact=5" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/Google.svg" width="100px" height="80px"></a>
        <a href="https://www.baidu.com/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/baidu.png" width="100px" height="80px"></a>
        <a href="https://www.jsdelivr.com/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/JsDelivr_Logo.svg" width="100px" height="80px"></a>
        <a href="https://github.com/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/github-logo.jpg" width="100px" height="80px"></a>
        <a href="https://aliyun.com/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/aliyun-logo.png" width="100px" height="80px"></a>
        <a href="https://dev.tencent.com/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wallleap/cdn/img/logo/tencentyun-logo.jpg" width="100px" height="80px"></a>   -->
      </div>
      <!-- <div>
        <a href="https://hexo.io" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Powered-Hexo-blue" alt="Hexo"></a>
        <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Theme-3--hexo-%232c2735" alt="3-blog"></a>
        <a href="https://github.com/" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Hosted-GitHub-%2324292e" alt="GitHub"></a>
        <a href="https://coding.net/" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Hosted-CODING-%23141a3f" alt="CODING"></a>
        <a href="https://www.jsdelivr.com/" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/CDN-jsDelivr-%23ee3232" alt="jsDelivr"></a>
      </div> -->
    </div><!-- .site-info -->
  </div>
    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


<script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'photoSwipe';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        

        // PhotoSwipe
        $('article').each(function(i){
            $(this).find('img').each(function(){
                if ($(this).closest('figure').hasClass('article-gallery-img')) {
                    return;
                }
                var alt = this.alt;
                $(this)
                    .wrap('<figure class="article-gallery-img" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"></figure>')
                    .wrap('<a href="' + this.src + '" title="' + alt + '"></a>');
                $(this).after('<div class="img_alt"><span>' + (alt || '') + '</span></div>');
            });
        });

        var pswpElement = document.querySelectorAll('.pswp')[0];
        if (pswpElement) {
            var gallerySelector = '.article-gallery, article';

            var initPhotoSwipeFromDOM = function(gallerySelector) {

                // parse slide data (url, title, size ...) from DOM elements
                // (children of gallerySelector)
                var parseThumbnailElements = function(el) {
                    var thumbElements = $(el).find('figure.article-gallery-img').toArray(),
                        numNodes = thumbElements.length,
                        items = [],
                        figureEl,
                        linkEl,
                        size,
                        imgEl,
                        item;

                    for (var i = 0; i < numNodes; i++) {

                        figureEl = thumbElements[i]; // <figure> element

                        // include only element nodes
                        if (figureEl.nodeType !== 1) {
                            continue;
                        }

                        linkEl = figureEl.children[0]; // <a> element
                        imgEl = linkEl.children[0]; // <img>

                        size = linkEl.getAttribute('data-size');
                        size = size && size.split('x');

                        // create slide object
                        item = {
                            src: linkEl.getAttribute('href'),
                            w: size && parseInt(size[0], 10) || imgEl.width,
                            h: size && parseInt(size[1], 10) || imgEl.height
                        };

                        if (figureEl.children.length > 1) {
                            // <figcaption> content
                            item.title = figureEl.children[1].innerHTML;
                        }

                        if (linkEl.children.length > 0) {
                            // <img> thumbnail element, retrieving thumbnail url
                            item.msrc = linkEl.children[0].getAttribute('src');
                        }

                        item.el = figureEl; // save link to element for getThumbBoundsFn
                        items.push(item);
                    }

                    return items;
                };

                // find nearest parent element
                var closest = function closest(el, fn) {
                    return el && (fn(el) ? el : closest(el.parentNode, fn));
                };

                // triggers when user clicks on thumbnail
                var onThumbnailsClick = function(e) {
                    e = e || window.event;

                    var eTarget = e.target || e.srcElement;

                    // find root element of slide
                    var clickedListItem = closest(eTarget, function(el) {
                        return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
                    });

                    if (!clickedListItem) {
                        return;
                    }

                    if (e.preventDefault) {
                        e.preventDefault();
                    } else {
                        e.returnValue = false;
                    }

                    // find index of clicked item by looping through all child nodes
                    // alternatively, you may define index via data- attribute
                    var clickedGallery = $(clickedListItem).closest(gallerySelector)[0],
                        childNodes = $(clickedGallery).find('figure.article-gallery-img').toArray(),
                        numChildNodes = childNodes.length,
                        nodeIndex = 0,
                        index;

                    for (var i = 0; i < numChildNodes; i++) {
                        if (childNodes[i].nodeType !== 1) {
                            continue;
                        }

                        if (childNodes[i] === clickedListItem) {
                            index = nodeIndex;
                            break;
                        }
                        nodeIndex++;
                    }



                    if (index >= 0) {
                        // open PhotoSwipe if valid index found
                        openPhotoSwipe(index, clickedGallery);
                    }
                    return false;
                };

                // parse picture index and gallery index from URL (#&pid=1&gid=2)
                var photoswipeParseHash = function() {
                    var hash = window.location.hash.substring(1),
                        params = {};

                    if (hash.length < 5) {
                        return params;
                    }

                    var vars = hash.split('&');
                    for (var i = 0; i < vars.length; i++) {
                        if (!vars[i]) {
                            continue;
                        }
                        var pair = vars[i].split('=');
                        if (pair.length < 2) {
                            continue;
                        }
                        params[pair[0]] = pair[1];
                    }

                    if (params.gid) {
                        params.gid = parseInt(params.gid, 10);
                    }

                    return params;
                };

                var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
                    var pswpElement = document.querySelectorAll('.pswp')[0],
                        gallery,
                        options,
                        items;

                    items = parseThumbnailElements(galleryElement);

                    // define options (if needed)
                    options = {

                        // define gallery index (for URL)
                        galleryUID: galleryElement.getAttribute('data-pswp-uid'),

                        getThumbBoundsFn: function(index) {
                            // See Options -> getThumbBoundsFn section of documentation for more info
                            var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
                                pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                                rect = thumbnail.getBoundingClientRect();

                            return {
                                x: rect.left,
                                y: rect.top + pageYScroll,
                                w: rect.width
                            };
                        }
                    };

                    // PhotoSwipe opened from URL
                    if (fromURL) {
                        if (options.galleryPIDs) {
                            // parse real index when custom PIDs are used
                            // http://photoswipe.com/documentation/faq.html#custom-pid-in-url
                            for (var j = 0; j < items.length; j++) {
                                if (items[j].pid == index) {
                                    options.index = j;
                                    break;
                                }
                            }
                        } else {
                            // in URL indexes start from 1
                            options.index = parseInt(index, 10) - 1;
                        }
                    } else {
                        options.index = parseInt(index, 10);
                    }

                    // exit if index not found
                    if (isNaN(options.index)) {
                        return;
                    }

                    if (disableAnimation) {
                        options.showAnimationDuration = 0;
                    }

                    // Pass data to PhotoSwipe and initialize it
                    gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);

                    gallery.listen('imageLoadComplete', function(index, item) {
                        var linkEl = item.el.children[0];
                        var img = item.container.children[0];
                        if (!linkEl.getAttribute('data-size')) {
                            linkEl.setAttribute('data-size', img.naturalWidth + 'x' + img.naturalHeight);
                            item.w = img.naturalWidth;
                            item.h = img.naturalHeight;
                            gallery.invalidateCurrItems();
                            gallery.updateSize(true);
                        }
                    });

                    gallery.init();
                };

                // loop through all gallery elements and bind events
                var galleryElements = document.querySelectorAll(gallerySelector);

                for (var i = 0, l = galleryElements.length; i < l; i++) {
                    galleryElements[i].setAttribute('data-pswp-uid', i + 1);
                    galleryElements[i].onclick = onThumbnailsClick;
                }

                // Parse URL and open gallery if it contains #&pid=3&gid=1
                var hashData = photoswipeParseHash();
                if (hashData.pid && hashData.gid) {
                    openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true);
                }
            };

            // execute above function
            initPhotoSwipeFromDOM(gallerySelector);
        }
        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    
    .nav-right nav a.hover > span{
        color: #03a788 !important;
    }
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element, as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. -->
        <!-- don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<div class="aplayer"

    data-id="2162711186"

    data-server="netease"

    data-type="playlist"

    data-fixed="true"

    data-autoplay="false"

    data-loop="all"

    data-order="random"

    data-preload="auto"

    data-volume="0.7"

    data-mutex="true"

>
</div>
<script src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>

<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>

<script>
(function() {

  var arr = new Array();
  var $tags = $('.post-tags').children('a');
  $tags.each(function() {
    arr.push($(this).html())
  })
  if (arr.indexOf("图集") !== -1) {

    $('.hj_img').each(function() {
      $(this).wrap('<a class="fancybox" data-fancybox="gallery" href="' + $(this).prop("src") + '"></a>'); 
    })
    //初始化fancybox，padding设为0，loop设为false
    $('.fancybox').fancybox({
      padding: 0,
      loop: false
    });
  }
})();
</script>

<!-- // 文字 -->
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/shehuizhuyi.js"></script>
<!-- // 爱心 -->
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/love.js"></script>
<!-- // 按键屏蔽 需要jQuery -->
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/js/noSomeKey.js"></script>

</html>
